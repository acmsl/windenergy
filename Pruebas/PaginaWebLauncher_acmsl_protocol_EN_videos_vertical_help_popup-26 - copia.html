<!DOCTYPE html>
<html lang="es">
<head>
  <link rel="icon" type="image/png" href="ACM_LOGO_42x37.png" />
  <link rel="shortcut icon" type="image/png" href="ACM_LOGO_42x37.png" />
  <meta charset="UTF-8" />
  <title>Wind Energy Applications</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <style>
    :root {
      --primary: #006699;
      --primary-light: #e3f4ff;
      --dark: #123047;
      --bg: #f5f7fb;
      --card-bg: #ffffff;
      --accent: #00a878;
      --danger: #c0392b;
      --radius: 12px;
      --shadow: 0 10px 25px rgba(0,0,0,0.08);
    }

    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
    }

    body {
      background: var(--bg);
      color: var(--dark);
      min-height: 100vh;
      display: flex;
      flex-direction: column;
    }

    header {
      background: linear-gradient(135deg, var(--primary), #0099cc);
      color: white;
      padding: 1.25rem 2rem;
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 1rem;
      box-shadow: 0 4px 15px rgba(0,0,0,0.2);
      position: sticky;
      top: 0;
      z-index: 10;
    }

    header h1 {
      font-size: 1.4rem;
      font-weight: 600;
    }

    header p {
      font-size: 0.9rem;
      opacity: 0.9;
    }

    .header-left {
      display: flex;
      align-items: center;
      gap: 0.9rem;
    }

    .logo-acm {
      height: 37px;
      width: auto;
      display: block;
    }

    .acmsl-text {
      font-size: 1.8rem;
      font-weight: 700;
      color: #ffffff;
      text-decoration: none;
      letter-spacing: 0.06em;
    }

    .acmsl-text:hover {
      text-decoration: underline;
    }


    .home-btn {
      border: none;
      background: rgba(255,255,255,0.12);
      color: white;
      padding: 0.6rem 1rem;
      border-radius: 999px;
      cursor: pointer;
      display: inline-flex;
      align-items: center;
      gap: 0.5rem;
      font-size: 0.9rem;
      transition: background 0.2s, transform 0.1s;
    }

    .home-btn:hover {
      background: rgba(255,255,255,0.25);
      transform: translateY(-1px);
    }

    main {
      flex: 1;
      max-width: 1100px;
      margin: 1.5rem auto 2rem;
      padding: 0 1rem;
      width: 100%;
    }

    section {
      display: none;
      animation: fadeIn 0.25s ease-out;
    }

    section.active {
      display: block;
    }

    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(6px); }
      to   { opacity: 1; transform: translateY(0); }
    }

    .section-header {
      margin-bottom: 1.5rem;
    }

    .section-header h2 {
      font-size: 1.3rem;
      margin-bottom: 0.3rem;
      color: var(--dark);
    }

    .section-header p {
      font-size: 0.95rem;
      color: #4a5a6a;
    }

    /* GRID LANDING 6 OPCIONES */
    .grid-6 {
      display: grid;
      grid-template-columns: repeat(auto-fit,minmax(300px,1fr));
      gap: 1.25rem;
    }

    .card {
      position: relative;
      background: var(--card-bg);
      border-radius: var(--radius);
      padding: 0;
      border: none;
      box-shadow: var(--shadow);
      cursor: pointer;
      overflow: hidden;
      display: flex;
      flex-direction: column;
      min-height: 180px;
      transition: transform 0.12s ease-out, box-shadow 0.12s ease-out;
    }

    .card:hover {
      transform: translateY(-3px);
      box-shadow: 0 14px 28px rgba(0,0,0,0.12);
    }

    .card-image {
      flex: 1;
      background-size: cover;
      background-position: center;
      filter: brightness(0.85);
      transition: filter 0.2s ease-out, opacity 0.2s ease-out;
    }

    .card-overlay {
      position: absolute;
      inset: 0;
      background: linear-gradient(to top, rgba(0,0,0,0.55), rgba(0,0,0,0.15));
      display: flex;
      align-items: flex-end;
      justify-content: center;
      padding: 1rem;
      text-align: center;
    }

    .card-title {
      color: white;
      font-weight: 600;
      text-shadow: 0 2px 4px rgba(0,0,0,0.5);
      font-size: 1.05rem;
    }

    /* HELP TEXT ON HOVER (OPCIONES 4 y 5 EN LANDING) */
    .card-help-text {
      position: absolute;
      inset: 0;
      padding: 1rem;
      display: flex;
      align-items: center;
      justify-content: center;
      text-align: center;
      background: var(--primary-light);
      color: var(--dark);
      font-size: 0.95rem;
      font-weight: 500;
      opacity: 0;
      pointer-events: none;
      transition: opacity 0.2s ease-out;
    }

    .card.help:hover .card-image,
    .card.help:hover .card-overlay {
      opacity: 0;
    }

    .card.help:hover .card-help-text {
      opacity: 1;
    }

    /* SUBOPCIONES */
    .suboptions {
      display: grid;
      grid-template-columns: repeat(auto-fit,minmax(260px,1fr));
      gap: 1.25rem;
    }

    .sub-card {
      background: var(--card-bg);
      border-radius: var(--radius);
      padding: 1.1rem 1.2rem;
      box-shadow: var(--shadow);
      border-left: 4px solid var(--primary);
      display: flex;
      flex-direction: column;
      gap: 0.4rem;
    }

    .sub-card h3 {
      font-size: 1.02rem;
      color: var(--dark);
    }

    .sub-card p {
      font-size: 0.9rem;
      color: #4a5a6a;
      flex: 1;
    }

    .btn-row {
      margin-top: 0.5rem;
      display: flex;
      flex-wrap: wrap;
      gap: 0.5rem;
    }

    .btn {
      border-radius: 999px;
      border: none;
      padding: 0.5rem 0.9rem;
      font-size: 0.9rem;
      cursor: pointer;
      display: inline-flex;
      align-items: center;
      gap: 0.3rem;
      transition: background 0.15s, transform 0.1s, box-shadow 0.1s;
      box-shadow: 0 2px 6px rgba(0,0,0,0.12);
    }

    .btn-primary {
      background: var(--primary);
      color: white;
    }
    .btn-primary:hover {
      background: #005580;
      transform: translateY(-1px);
    }

    .btn-secondary {
      background: #ecf1f8;
      color: var(--dark);
    }
    .btn-secondary:hover {
      background: #dde5f2;
      transform: translateY(-1px);
    }

    .btn-ghost {
      background: transparent;
      border: 1px solid #c4cfdd;
      box-shadow: none;
    }
    .btn-ghost:hover {
      background: #edf1f8;
    }

    /* OPCION 3: 3 CARDS EN UNA FILA */
    .row-3 {
      display: grid;
      grid-template-columns: repeat(3, minmax(0,1fr));
      gap: 1.25rem;
    }

    @media (max-width: 900px) {
      .row-3 {
        grid-template-columns: repeat(auto-fit,minmax(240px,1fr));
      }
    }

    .sim-card {
      position: relative;
      background: var(--card-bg);
      border-radius: var(--radius);
      overflow: hidden;
      min-height: 190px;
      box-shadow: var(--shadow);
      cursor: pointer;
      display: flex;
      flex-direction: column;
      transition: transform 0.12s, box-shadow 0.12s;
    }

    .sim-card:hover {
      transform: translateY(-3px);
      box-shadow: 0 14px 28px rgba(0,0,0,0.12);
    }

    .sim-image {
      flex: 1;
      background-size: cover;
      background-position: center;
      filter: brightness(0.85);
      transition: opacity 0.2s ease-out;
    }

    .sim-overlay {
      position: absolute;
      inset: 0;
      display: flex;
      align-items: flex-end;
      justify-content: center;
      padding: 0.9rem;
      background: linear-gradient(to top, rgba(0,0,0,0.5), rgba(0,0,0,0.1));
      color: white;
      font-weight: 600;
      text-align: center;
      font-size: 0.98rem;
    }

    .sim-help {
      position: absolute;
      inset: 0;
      padding: 1rem;
      display: flex;
      align-items: center;
      justify-content: center;
      text-align: center;
      background: var(--primary-light);
      color: var(--dark);
      opacity: 0;
      transition: opacity 0.2s ease-out;
      font-size: 0.93rem;
      font-weight: 500;
    }

    .sim-card:hover .sim-image,
    .sim-card:hover .sim-overlay {
      opacity: 0;
    }

    .sim-card:hover .sim-help {
      opacity: 1;
    }

    /* VIDEOS */
    .video-wrapper {
      background: var(--card-bg);
      border-radius: var(--radius);
      padding: 1.1rem 1.25rem 1.4rem;
      box-shadow: var(--shadow);
    }

    .video-wrapper h3 {
      margin-bottom: 0.3rem;
    }

    .video-wrapper p {
      font-size: 0.9rem;
      margin-bottom: 0.8rem;
      color: #4a5a6a;
    }

    .video-frame {
      position: relative;
      width: 100%;
      padding-bottom: 56.25%; /* 16:9 */
      border-radius: 10px;
      overflow: hidden;
      background: #000;
    }

    .video-frame iframe {
      position: absolute;
      inset: 0;
      width: 100%;
      height: 100%;
      border: 0;
    }

    /* PEQUE√ëO TOAST PARA ERRORES / ESTADO */
    .toast {
      position: fixed;
      bottom: 1.2rem;
      right: 1.2rem;
      background: #333;
      color: #fff;
      padding: 0.6rem 0.9rem;
      border-radius: 999px;
      font-size: 0.85rem;
      opacity: 0;
      transform: translateY(10px);
      pointer-events: none;
      transition: opacity 0.2s, transform 0.2s;
      z-index: 20;
    }

    .toast.show {
      opacity: 1;
      transform: translateY(0);
      pointer-events: auto;
    }

  /* VIDEOS (dynamic list) */
/* Video modal */
.modal-backdrop {
  position: fixed;
  inset: 0;
  background: rgba(0,0,0,0.55);
  display: none;
  align-items: center;
  justify-content: center;
  padding: 1.2rem;
  z-index: 999;
}

.modal-backdrop.show {
  display: flex;
}

.modal {
  width: min(980px, 96vw);
  background: var(--card-bg);
  border-radius: 16px;
  box-shadow: 0 24px 60px rgba(0,0,0,0.3);
  overflow: hidden;
}

.modal-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  gap: 0.75rem;
  padding: 0.9rem 1rem;
  border-bottom: 1px solid rgba(0,0,0,0.08);
}

.modal-header .modal-title {
  font-weight: 650;
  color: var(--dark);
  font-size: 1rem;
  overflow: hidden;
  white-space: nowrap;
  text-overflow: ellipsis;
}

.modal-close {
  border: none;
  background: #ecf1f8;
  color: var(--dark);
  border-radius: 999px;
  padding: 0.45rem 0.75rem;
  cursor: pointer;
}

.modal-body {
  position: relative;
  width: 100%;
  padding-bottom: 56.25%; /* 16:9 */
  background: #000;
}

.modal-body iframe {
  position: absolute;
  inset: 0;
  width: 100%;
  height: 100%;
  border: 0;
}


/* VIDEOS (dynamic list) - vertical cards */
.videos-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(260px, 1fr));
  gap: 1.25rem;
}

.video-card {
  background: var(--card-bg);
  border-radius: var(--radius);
  box-shadow: var(--shadow);
  overflow: hidden;
  display: flex;
  flex-direction: column;
}

.video-thumb {
  width: 100%;
  aspect-ratio: 16 / 9;
  background: #000;
  cursor: pointer;
  display: flex;
  align-items: center;
  justify-content: center;
}

.video-thumb img {
  width: 100%;
  height: 100%;
  object-fit: cover;
  display: block;
}

.video-content {
  padding: 0.9rem 1rem 1rem;
  display: flex;
  flex-direction: column;
  gap: 0.7rem;
}

.video-title {
  font-weight: 650;
  color: var(--dark);
  font-size: 1rem;
  line-height: 1.25;
}

.video-buttons {
  display: flex;
  flex-wrap: wrap;
  gap: 0.5rem;
}

.help-btn {
  background: #ecf1f8;
  color: var(--dark);
}

.help-btn:hover {
  background: #dde5f2;
}
</style>
</head>
<body>

<header>
  <div class="header-left">
    <img src="ACM_LOGO_42x37.png" alt="Logo ACM" class="logo-acm" />
    <a href="https://www.acm-sl.com" target="_blank" rel="noopener noreferrer" class="acmsl-text">ACMSL</a>
    <div>
      <h1>Wind Energy Applications</h1>
      <p>Seleccione una opci√≥n para acceder a simuladores, formaci√≥n y material multimedia.</p>
    </div>
  </div>
  <button class="home-btn" type="button" onclick="showSection('landing')">
    ‚¨Ö Volver al inicio
  </button>
</header>

<main>
  <!-- LANDING: 6 OPCIONES -->
  <section id="landing" class="active">
    <div class="section-header">
      <h2>Seleccione una categor√≠a</h2>
      <p>Haga clic en una de las siguientes opciones para acceder a las aplicaciones correspondientes.</p>
    </div>

    <div class="grid-6">
      <!-- 1. Introducci√≥n a la Energ√≠a E√≥lica -->
      <button class="card" type="button" data-target="opcion1">
        <div class="card-image" style="background-image:url('img/opcion1-introduccion.jpg');"></div>
        <div class="card-overlay">
          <div class="card-title">Introducci√≥n a la Energ√≠a E√≥lica</div>
        </div>
      </button>

      <!-- 2. Wind Farms -->
      <button class="card" type="button" data-target="opcion2">
        <div class="card-image" style="background-image:url('ParqueEolico.png');"></div>
        <div class="card-overlay">
          <div class="card-title">Wind Farms</div>
        </div>
      </button>

      <!-- 3. Aerogeneradores en Parques E√≥licos -->
      <button class="card" type="button" data-target="opcion3">
        <div class="card-image" style="background-image:url('img/opcion3-aerogeneradores.jpg');"></div>
        <div class="card-overlay">
          <div class="card-title">Aerogeneradores en Parques E√≥licos</div>
        </div>
      </button>

      <!-- 4. Analysis del Tren de Potencia (hover ayuda) -->
      <button class="card help" type="button" data-target="opcion4">
        <div class="card-image" style="background-image:url('img/opcion4-tren-potencia.jpg');"></div>
        <div class="card-overlay">
          <div class="card-title">Analysis del Tren de Potencia</div>
        </div>
        <div class="card-help-text">
          Este programa le permite analizar el comportamiento del tren de potencia de un aerogenerador, 
          identificando p√©rdidas, rendimientos y puntos cr√≠ticos de funcionamiento.
        </div>
      </button>

      <!-- 5. C√°lculos sobre Back-to-Back converters (hover ayuda) -->
      <button class="card help" type="button" data-target="opcion5">
        <div class="card-image" style="background-image:url('img/opcion5-back-to-back.jpg');"></div>
        <div class="card-overlay">
          <div class="card-title">C√°lculos sobre Back-to-Back converters</div>
        </div>
        <div class="card-help-text">
          Este programa le permite realizar c√°lculos y an√°lisis sobre convertidores Back-to-Back,
          evaluando corrientes, tensiones, arm√≥nicos y estrategias de control.
        </div>
      </button>

      <!-- 6. V√≠deos interesantes -->
      <button class="card" type="button" data-target="opcion6">
        <div class="card-image" style="background-image:url('img/opcion6-videos.jpg');"></div>
        <div class="card-overlay">
          <div class="card-title">V√≠deos interesantes</div>
        </div>
      </button>
    </div>
  </section>

  <!-- OPCI√ìN 1: INTRODUCCI√ìN A LA ENERG√çA E√ìLICA -->
  <section id="opcion1">
    <div class="section-header">
      <h2>Introducci√≥n a la Energ√≠a E√≥lica</h2>
      <p>Seleccione una de las aplicaciones disponibles.</p>
    </div>

    <div class="suboptions">
      <!-- 1-1 -->
      <div class="sub-card">
        <h3>1-1 Mind Map mental con conceptos en Energ√≠a E√≥lica</h3>
        <p>Acceda a un mapa mental interactivo con los conceptos fundamentales de la energ√≠a e√≥lica.</p>
        <div class="btn-row">
          <button class="btn btn-primary" type="button"
                  onclick="runAfile(\'mapa_mental_energia_eolica.bat\')">
            ‚ñ∂ Run proceso
          </button>
        </div>
      </div>

      <!-- 1-2 -->
      <div class="sub-card">
        <h3>1-2 Training en aspectos industriales de la Energ√≠a E√≥lica</h3>
        <p>Inicie una sesi√≥n de formaci√≥n centrada en la realidad industrial del sector e√≥lico.</p>
        <div class="btn-row">
          <button class="btn btn-primary" type="button"
                  onclick="runAfile(\'formacion_aspectos_industriales.bat\')">
            ‚ñ∂ Run proceso
          </button>
        </div>
      </div>
    </div>
  </section>

  <!-- OPCI√ìN 2: PARQUES E√ìLICOS -->
  <section id="opcion2">
    <div class="section-header">
      <h2>Wind Farms</h2>
      <p>Elija la herramienta relacionada con parques e√≥licos.</p>
    </div>

    <div class="suboptions">
      <!-- 2-1 -->
      <div class="sub-card">
        <h3>2-1 Lanzamiento del Simulator de Parque E√≥lico</h3>
        <p>
          Ejecuta el simulador completo de un parque e√≥lico para el an√°lisis de producci√≥n y operaci√≥n.
        </p>
        <div class="btn-row">
          <button class="btn btn-primary" type="button"
                  onclick="runAldp('WFSSCADA','Spanish')">
            ‚ñ∂ Run simulador
          </button>
        </div>
      </div>

      <!-- 2-2 -->
      <div class="sub-card">
        <h3>2-2 Exploraci√≥n guiada del Centro de Control</h3>
        <p>
          Abra la gu√≠a ya disponible del Centro de Control (SCADA) del parque e√≥lico, con una exploraci√≥n guiada
          de sus funcionalidades.
        </p>
        <div class="btn-row">
          <button class="btn btn-secondary" type="button"
                  onclick="abrirGuiaSCADA()">
            üìñ Abrir gu√≠a SCADA
          </button>
        </div>
      </div>
    </div>
  </section>

  <!-- OPCI√ìN 3: AEROGENERADORES EN PARQUES E√ìLICOS -->
  <section id="opcion3">
    <div class="section-header">
      <h2>Aerogeneradores en Parques E√≥licos</h2>
      <p>Pase el rat√≥n por cada simulador para ver su descripci√≥n y haga clic para lanzarlo.</p>
    </div>

    <div class="row-3">
      <!-- 3-1 -->
      <div class="sim-card" onclick="runAfile(\'sim_aerogenerador_jaula_active_stall.bat\')">
        <div class="sim-image" style="background-image:url('img/sim-3-1.jpg');"></div>
        <div class="sim-overlay">
          3-1 Generador de jaula de ardilla (Active Stall)
        </div>
        <div class="sim-help">
          Este simulador sirve para analizar el comportamiento de un aerogenerador con generador
          de jaula de ardilla y control por <em>Active Stall</em>, incluyendo curvas de potencia
          y respuesta ante variaciones de viento.
        </div>
      </div>

      <!-- 3-2 -->
      <div class="sim-card" onclick="runAfile(\'sim_aerogenerador_control_resistencia_rotor.bat\')">
        <div class="sim-image" style="background-image:url('img/sim-3-2.jpg');"></div>
        <div class="sim-overlay">
          3-2 Control por Resistencia del Rotor
        </div>
        <div class="sim-help">
          Este simulador sirve para estudiar el control de potencia y par en aerogeneradores
          mediante la variaci√≥n de la resistencia del rotor, permitiendo explorar diferentes escenarios de operaci√≥n.
        </div>
      </div>

      <!-- 3-3 -->
      <div class="sim-card" onclick="runAdfig('DFIG','Spanish')">
        <div class="sim-image" style="background-image:url('img/sim-3-3.jpg');"></div>
        <div class="sim-overlay">
          3-3 Generador doblemente alimentado (DFIG)
        </div>
        <div class="sim-help">
          Este simulador sirve para analizar un aerogenerador con generador doblemente alimentado (DFIG),
          incluyendo estrategias de control vectorial y su interacci√≥n con la red.
        </div>
      </div>
    </div>
  </section>

  <!-- OPCI√ìN 4: AN√ÅLISIS DEL TREN DE POTENCIA -->
  <section id="opcion4">
    <div class="section-header">
      <h2>Analysis del Tren de Potencia</h2>
      <p>
        Programa para el estudio detallado del tren de potencia de un aerogenerador.
      </p>
    </div>

    <div class="sub-card">
      <h3>Lanzar herramienta de an√°lisis del tren de potencia</h3>
      <p>
        Este programa le permite estudiar cada componente del tren de potencia (multiplicadora, eje, generador, etc.),
        evaluando p√©rdidas, rendimientos y respuesta din√°mica.
      </p>
      <div class="btn-row">
        <button class="btn btn-primary" type="button"
                onclick="runAfile(\'analisis_tren_potencia.bat\')">
          ‚ñ∂ Run herramienta
        </button>
      </div>
    </div>
  </section>

  <!-- OPCI√ìN 5: C√ÅLCULOS SOBRE BACK-TO-BACK CONVERTERS -->
  <section id="opcion5">
    <div class="section-header">
      <h2>C√°lculos sobre Back-to-Back converters</h2>
      <p>
        Herramienta de an√°lisis y c√°lculo para convertidores Back-to-Back.
      </p>
    </div>

    <div class="sub-card">
      <h3>Lanzar herramienta de c√°lculo Back-to-Back</h3>
      <p>
        Este programa le permite analizar corrientes, tensiones, p√©rdidas y arm√≥nicos en convertidores
        Back-to-Back, as√≠ como estudiar diferentes estrategias de control.
      </p>
      <div class="btn-row">
        <button class="btn btn-primary" type="button"
                onclick="runAfile(\'calculos_back_to_back.bat\')">
          ‚ñ∂ Run herramienta
        </button>
      </div>
    </div>
  </section>

  <!-- OPTION 6: INTERESTING VIDEOS -->
<section id="opcion6">
  <div class="section-header">
    <h2>Interesting videos</h2>
    <p>
      Select a video to watch. Titles come from <code>Videos.txt</code>.
    </p>
  </div>

  <div id="videos-container" class="videos-grid"></div>
</section>
</main>

<div id="toast" class="toast"></div>

  <!-- Embedded videos catalog (Option C: offline, no fetch). Replace the contents with your Videos.txt XML -->
  <script id="videosXml" type="text/plain">
<Root>
  <Video>
    <Exec>https://www.acm-sl.com/en/video-presentation-wfs</Exec>
    <Title>Description of one Wind Turbine simulator</Title>
    <Help>This video contains a short introduction to the Simulator for the Wind Turbine with Active Stall control.</Help>
  </Video>

  <Video>
    <Exec>https://www.acm-sl.com/en/video-start-stop-operations-in-wind-turbine</Exec>
    <Title>START and STOP operations of a Wind Turbine</Title>
    <Help>In this video you can observe the evolution of the Wind Turbine of the Active Stall type, with squirrel cage electric Generator directly connected to the Grid, during two basic operations: START (from disconnected from the Grid to connection, and start production - <i>cutin</i>-), and STOP (from production state to stop state - <i>cutout</i>).</Help>
  </Video>

  <Video>
    <Exec>https://www.acm-sl.com/en/video-incidences-management-in-wind-turbine</Exec>
    <Title>Management of incidences</Title>
    <Help>
      <i>Incidences</i> are a key concept in Wind Turbines: Wind Turbines are <i>Production Plants</i>, designed to operate in stand-alone mode, adapting their behavior to the changing conditions (wind speed, wind direction, failures in the Grid, internal failures, etc.)
      <p>Whenever a subsystem is not working properly, or some variable goes out of range, its Controller supplies information (incidence) that can be used to analyse the actual condition of the Wind Turbine.</p>
      <p>Familiarity with the possible <i>incidences</i> in a Wind Turbine is a must for anyone involved in its Operation and Maintenance.</p>
    </Help>
  </Video>

  <Video>
    <Exec>https://www.youtube.com/watch?v=84BeVq2Jm88</Exec>
    <Title>Erection of a Wind Turbine - MidAmerican Energy -</Title>
    <Help></Help>
  </Video>

  <Video>
    <Exec>https://youtu.be/whTfACs0Og8?t=8</Exec>
    <Title>Use of WindFarmSimulator suite in Minnesota West Technical College</Title>
    <Help>This video by West Technical College presents their installations for Training in Wind Turbine technologies. It shows our WindFarmSimulator in use.</Help>
  </Video>

  <Video>
    <Exec>https://www.youtube.com/watch?v=7EQa-WZ9c3g</Exec>
    <Title>Construction of Wind Turbine subsystems</Title>
    <Help>Videos showing the construction of different subsystems of a Wind Turbine, notably the Yaw system in the Nacelle.</Help>
  </Video>

  <Video>
    <Exec>https://www.youtube.com/watch?v=THf6svHoqaA</Exec>
    <Title>Visit inside a Wind Turbine</Title>
    <Help></Help>
  </Video>

  <Video>
    <Exec>https://www.youtube.com/watch?v=2KxbqZzehYg</Exec>
    <Title>3D view of the components of a Wind Turbine</Title>
    <Help></Help>
  </Video>

  <Video>
    <Exec>https://www.youtube.com/watch?v=ARd-Om2VyiE</Exec>
    <Title>Planetary stage in a Wind Turbine Gearbox</Title>
    <Help></Help>
  </Video>
</Root>
</script>

<script>
  // --- Navigation between "pages" (sections) ---
  function showSection(id) {
    document.querySelectorAll('main section').forEach(sec => {
      sec.classList.toggle('active', sec.id === id);
    });
  }

  // Click on landing cards
  document.querySelectorAll('.card[data-target]').forEach(card => {
    card.addEventListener('click', () => {
      const target = card.getAttribute('data-target');
      showSection(target);
    });
  });

  // --- Small toast for status/errors ---
  function showToast(msg, type = 'info') {
    const toast = document.getElementById('toast');
    toast.textContent = msg;
    toast.style.background =
      type === 'error' ? '#c0392b' :
      type === 'success' ? '#00a878' : '#333';
    toast.classList.add('show');
    setTimeout(() => toast.classList.remove('show'), 3000);
  }

  // --- ACMSL custom protocol launchers ---
  // NOTE: These functions build a custom URI and trigger the OS handler via window.location.href.

  function _acmslEnc(s) {
    // Replace spaces with %20 (keep other characters as-is, matching your command format)
    return String(s ?? "").replace(/ /g, "%20");
  }

  function _toHex(str) {
    // Two hex chars per character (00-FF), uppercase
    let out = "";
    const s = String(str ?? "");
    for (let i = 0; i < s.length; i++) {
      out += s.charCodeAt(i).toString(16).toUpperCase().padStart(2, "0");
    }
    return out;
  }

  function runAldp(param1, param2) {
    const comando = "acmsl://ldp%20-c%20" + _acmslEnc(param1) + "%20-l%20" + _acmslEnc(param2);
    window.location.href = comando;
  }

  function runAopercurv(param1) {
    const comando = "acmsl://operationalcurvewt%20-v%20-name%20" + _acmslEnc(param1);
    window.location.href = comando;
  }

  function runAdfig(param1, param2) {
    // dfigb2b -v -name <param1> <param2>
    const comando = "acmsl://dfigb2b%20-v%20-name%20" + _acmslEnc(param1) + "%20" + _acmslEnc(param2);
    window.location.href = comando;
  }

  function runAviewer(param1) {
    const comandoHex = _toHex(param1);
    const comando = "acmsl://viewertutorial%20-h" + comandoHex;
    window.location.href = comando;
  }

  function runAfile(param1) {
    const comandoHex = _toHex(param1);
    const comando = "acmsl://file%20-h" + comandoHex;
    window.location.href = comando;
  }

  // Open existing SCADA guide (relative path)
  function abrirGuiaSCADA() {
    window.location.href = 'Guia_Simulator_WFS_SCADA_Parque_Eolico/index.html';
  }

  // Open video in a new window/tab
  function abrirVideoEnVentana() {
    const urlVideo = 'https://www.youtube.com/watch?v=dQw4w9WgXcQ'; // replace with your real URL
    window.open(urlVideo, '_blank', 'noopener');
  }
// --- Videos (loaded from Videos.txt on first entry) ---
let _videosLoaded = false;

function _extractYouTubeId(url) {
  try {
    const u = new URL(url);
    if (u.hostname.includes('youtu.be')) {
      return u.pathname.replace('/', '');
    }
    if (u.hostname.includes('youtube.com')) {
      return u.searchParams.get('v');
    }
  } catch (e) {
    // ignore
  }
  return null;
}

function _thumbFromUrl(url) {
  const yt = _extractYouTubeId(url);
  if (yt) return "https://img.youtube.com/vi/" + yt + "/hqdefault.jpg";
  // fallback (local banner if present)
  return "BannerVistaMolinos.png";
}

function _embedUrl(url) {
  const yt = _extractYouTubeId(url);
  if (yt) return "https://www.youtube.com/embed/" + yt;
  return url; // fallback (may or may not be embeddable)
}

async function initVideosOnce() {
  if (_videosLoaded) return;
  _videosLoaded = true;

  const container = document.getElementById('videos-container');
  if (!container) return;

  // Loading placeholder
  container.innerHTML = '<div class="video-wrapper"><h3>Loading videos‚Ä¶</h3><p>Please wait.</p></div>';

  try {
    const xmlHolder = document.getElementById('videosXml');
const xmlText = (xmlHolder ? xmlHolder.textContent : '').trim();
if (!xmlText) throw new Error('Embedded videosXml is empty');
const doc = new DOMParser().parseFromString(xmlText, 'text/xml');

      // Your file format: <Option><Exec>...</Exec><Title>...</Title><Help>...</Help></Option>
      const options = Array.from(doc.getElementsByTagName('Video'));
      const legacyOptions = Array.from(doc.getElementsByTagName('Option'));
      const itemsAll = options.length ? options : legacyOptions;

      if (!itemsAll.length) {
        container.innerHTML = '<div class="video-wrapper"><h3>No videos found</h3><p>Check that Videos.txt contains <code>&lt;Video&gt;</code> entries.</p></div>';
        return;
      }

      // Helper: get inner XML (so <i>, <p> etc. inside <Help> are preserved)
      function innerXml(node) {
        if (!node) return '';
        let s = '';
        node.childNodes.forEach(ch => {
          if (ch.nodeType === Node.TEXT_NODE) s += ch.textContent;
          else if (ch.nodeType === Node.ELEMENT_NODE) s += ch.outerHTML;
        });
        return s.trim();
      }

      // De-duplicate by Exec + Title (some files may contain duplicates)
      const seen = new Set();

      container.innerHTML = '';
      itemsAll.forEach(opt => {
        const execNode = opt.getElementsByTagName('Exec')[0];
        const titleNode = opt.getElementsByTagName('Title')[0];
        const helpNode = opt.getElementsByTagName('Help')[0];

        const exec = (execNode ? execNode.textContent : '').trim();
        const title = (titleNode ? titleNode.textContent : 'Video').trim();
        const helpHtml = innerXml(helpNode);

        if (!exec) return;

        const key = exec + '|' + title;
        if (seen.has(key)) return;
        seen.add(key);

        const card = document.createElement('div');
card.className = 'video-card';

const thumb = document.createElement('div');
thumb.className = 'video-thumb';
thumb.title = 'Open video';
thumb.innerHTML = '<img alt="" src="' + _thumbFromUrl(exec) + '">';

// Open in new tab/window (avoids YouTube embed Error 153 in local contexts)
thumb.addEventListener('click', () => window.open(exec, '_blank', 'noopener'));

const content = document.createElement('div');
content.className = 'video-content';

const t = document.createElement('div');
t.className = 'video-title';
t.textContent = title;

const buttons = document.createElement('div');
buttons.className = 'video-buttons';

const openBtn = document.createElement('button');
openBtn.className = 'btn btn-primary';
openBtn.type = 'button';
openBtn.textContent = '‚ñ∂ Open';
openBtn.addEventListener('click', () => window.open(exec, '_blank', 'noopener'));

const helpBtn = document.createElement('button');
helpBtn.className = 'btn help-btn';
helpBtn.type = 'button';
helpBtn.textContent = '‚Ñπ Help';
helpBtn.disabled = !helpHtml;
helpBtn.addEventListener('click', () => openHelpModal(title, helpHtml));

buttons.appendChild(openBtn);
buttons.appendChild(helpBtn);

content.appendChild(t);
content.appendChild(buttons);

card.appendChild(thumb);
card.appendChild(content);

container.appendChild(card);
});
} catch (err) {
    console.error(err);
    container.innerHTML =
      '<div class="video-wrapper">' +
      '<h3>Cannot load embedded videos list</h3>' +
      '<p>The embedded <code>&lt;script id="videosXml" type="text/plain"&gt;</code> block is empty or invalid. ' +
      'Your file should be XML like: <code>&lt;Root&gt;&lt;Video&gt;&lt;Exec&gt;...&lt;/Exec&gt;&lt;Title&gt;...&lt;/Title&gt;&lt;Help&gt;...&lt;/Help&gt;&lt;/Video&gt;&lt;/Root&gt;</code>.</p>' +
      '</div>';
  }
}

function openVideo(title, url) {
  const backdrop = document.getElementById('videoModalBackdrop');
  const frame = document.getElementById('videoModalFrame');
  const t = document.getElementById('videoModalTitle');

  t.textContent = title || 'Video';
  frame.src = _embedUrl(url);

  backdrop.classList.add('show');
}

function openHelpModal(title, helpHtml) {
  const backdrop = document.getElementById('helpModalBackdrop');
  const t = document.getElementById('helpModalTitle');
  const body = document.getElementById('helpModalBody');

  t.textContent = title || 'Help';
  body.innerHTML = helpHtml || '';

  backdrop.classList.add('show');
}

function closeHelpModal() {
  const backdrop = document.getElementById('helpModalBackdrop');
  const body = document.getElementById('helpModalBody');
  backdrop.classList.remove('show');
  body.innerHTML = '';
}

// Close help modal on backdrop click
document.addEventListener('click', (e) => {
  const backdrop = document.getElementById('helpModalBackdrop');
  if (!backdrop) return;
  if (e.target === backdrop) closeHelpModal();
});

function closeVideoModal() {
  const backdrop = document.getElementById('videoModalBackdrop');
  const frame = document.getElementById('videoModalFrame');
  backdrop.classList.remove('show');
  // Stop playback
  frame.src = '';
}

// Close modal on backdrop click
document.addEventListener('click', (e) => {
  const backdrop = document.getElementById('videoModalBackdrop');
  if (!backdrop) return;
  if (e.target === backdrop) closeVideoModal();
});

// Ensure videos are loaded on first entry to the section
const _oldShowSection = showSection;
showSection = function(id) {
  _oldShowSection(id);
  if (id === 'opcion6') initVideosOnce();
};

</script>

<!-- Video modal -->
<div id="videoModalBackdrop" class="modal-backdrop" role="dialog" aria-modal="true" aria-label="Video player">
  <div class="modal">
    <div class="modal-header">
      <div id="videoModalTitle" class="modal-title">Video</div>
      <button class="modal-close" type="button" onclick="closeVideoModal()">‚úï Close</button>
    </div>
    <div class="modal-body">
      <iframe id="videoModalFrame" src="" title="Video player" allowfullscreen></iframe>
    </div>
  </div>
</div>

<!-- Help modal -->
<div id="helpModalBackdrop" class="modal-backdrop" role="dialog" aria-modal="true" aria-label="Help">
  <div class="modal">
    <div class="modal-header">
      <div id="helpModalTitle" class="modal-title">Help</div>
      <button class="modal-close" type="button" onclick="closeHelpModal()">‚úï Close</button>
    </div>
    <div class="modal-body" style="padding:1rem; background: var(--card-bg);">
      <div id="helpModalBody" class="video-help"></div>
    </div>
  </div>
</div>

</body>
</html>
