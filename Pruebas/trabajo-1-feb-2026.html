<!DOCTYPE html>
<html lang="es">
  <head>
    <link rel="icon" type="image/png" href="img/ACM_LOGO.png" />
    <link rel="shortcut icon" type="image/png" href="img/ACM_LOGO.png" />
    <meta charset="UTF-8" />
    <title>Wind Turbine Real-Time Simulators, Training & Engineering Tools</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <style>
      :root {
        --primary: #006699;
        --primary-light: #e3f4ff;
        --dark: #123047;
        --bg: #f5f7fb;
        --card-bg: #ffffff;
        --accent: #00a878;
        --danger: #c0392b;
        --radius: 12px;
        --shadow: 0 10px 25px rgba(0,0,0,0.08);
      }

      * {
        box-sizing: border-box;
        margin: 0;
        padding: 0;
        font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      }

      body {
        background: var(--bg);
        color: var(--dark);
        min-height: 100vh;
        display: flex;
        flex-direction: column;
      }

      header {
        background: linear-gradient(135deg, var(--primary), #0099cc);
        color: white;
        padding: 1.25rem 2rem;
        display: flex;
        align-items: center;
        justify-content: space-between;
        gap: 1rem;
        box-shadow: 0 4px 15px rgba(0,0,0,0.2);
        position: sticky;
        top: 0;
        z-index: 200;
      }

      header h1 {
        font-size: 1.4rem;
        font-weight: 600;
      }

      header p {
        font-size: 0.9rem;
        opacity: 0.9;
      }

      .header-left {
        display: flex;
        align-items: center;
        gap: 0.9rem;
      }

      .logo-acm {
        height: 37px;
        width: auto;
        display: block;
      }

      .acmsl-text {
        font-size: 1.8rem;
        font-weight: 700;
        color: #ffffff;
        text-decoration: none;
        letter-spacing: 0.06em;
      }

      .acmsl-text:hover {
        text-decoration: underline;
      }

      .home-btn {
        border: none;
        background: rgba(255,255,255,0.12);
        color: white;
        padding: 0.6rem 1rem;
        border-radius: 999px;
        cursor: pointer;
        display: inline-flex;
        align-items: center;
        gap: 0.5rem;
        font-size: 0.9rem;
        transition: background 0.2s, transform 0.1s;
      }

      .home-btn:hover {
        background: rgba(255,255,255,0.25);
        transform: translateY(-1px);
      }

      .breadcrumb {
        position: sticky;
        top: 5rem;
        background: var(--bg);
        padding: 0.25rem 2rem;
        font-size: 0.75rem;
        color: #666;
        font-style: italic;
        border-bottom: 1px solid rgba(0,0,0,0.05);
        z-index: 100;
        line-height: 1.2;
      }

      .breadcrumb span {
        margin: 0 0.3rem;
      }

      .bc-link {
        color: var(--primary);
        cursor: pointer;
        text-decoration: none;
        transition: color 0.2s;
      }

      .bc-link:hover {
        color: #005580;
        text-decoration: underline;
      }

      .bc-current {
        color: var(--dark);
        font-weight: 500;
      }

      main {
        flex: 1;
        max-width: 1100px;
        margin: 1.5rem auto 2rem;
        padding: 0 1rem;
        width: 100%;
      }

      section {
        display: none;
        animation: fadeIn 0.25s ease-out;
      }

      section.active {
        display: block;
      }

      @keyframes fadeIn {
        from { opacity: 0; transform: translateY(6px); }
        to   { opacity: 1; transform: translateY(0); }
      }

      .section-header {
        margin-bottom: 1.5rem;
        z-index: 5;
      }

      .section-header h2 {
        font-size: 1.3rem;
        margin-bottom: 0.3rem;
        color: var(--dark);
      }

      .section-header p {
        font-size: 0.95rem;
        color: #4a5a6a;
      }

      /* GRID LANDING 6 OPCIONES */
      .grid-6 {
        display: grid;
        grid-template-columns: repeat(auto-fit,minmax(300px,1fr));
        gap: 1.25rem;
      }

      .card {
        position: relative;
        background: var(--card-bg);
        border-radius: var(--radius);
        padding: 0;
        border: none;
        box-shadow: var(--shadow);
        cursor: pointer;
        overflow: visible;
        display: flex;
        flex-direction: column;
        min-height: 180px;
        transition: transform 0.12s ease-out, box-shadow 0.12s ease-out;
      }

      .card:hover {
        transform: translateY(-3px);
        box-shadow: 0 14px 28px rgba(0,0,0,0.12);
        z-index: 12000;
      }

      .card-image {
        flex: 1;
        min-height: 200px;
        background-size: cover;
        background-position: center;
        filter: brightness(0.85);
        transition: filter 0.2s ease-out, opacity 0.2s ease-out;
        z-index: 10;
      }

      .card-overlay {
        position: absolute;
        inset: 0;
        display: flex;
        align-items: flex-end;
        justify-content: center;
        padding: 1rem;
        text-align: center;
      }

      .card-title {
        color: black;
        font-weight: 600;
        text-shadow: 0 2px 4px rgba(0,0,0,0.5);
        font-size: 1.05rem;
      }

      /* HELP TEXT ON HOVER (OPCIONES 4 y 5 EN LANDING) */
      .card-help-text {
        position: absolute;
        inset: 0;
        padding: 1rem;
        display: flex;
        align-items: center;
        justify-content: center;
        text-align: center;
        background: var(--primary-light);
        color: var(--dark);
        font-size: 0.95rem;
        font-weight: 500;
        opacity: 0;
        pointer-events: none;
        transition: opacity 0.2s ease-out;
      }

      .card.help:hover .card-image,
      .card.help:hover .card-overlay {
        opacity: 0.5;
        z-index: 10;
      }

      .card.help:hover .card-help-text {
        opacity: 1;
      }

      .card.help:hover::before{
        content:"";
        position: fixed;
        inset: 0;
        background: rgba(0,0,0,0.35);
        z-index: 10010;
      }

      /* Popup con imagen cortesia de CoPilot */
      .card-help-popup {
        display: none;
        position: fixed;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        width: 600px;
        max-width: 90vw;     /* para que no se salga en pantallas peque√±as */
        max-height: 85vh;    /* para que no se corte */
        overflow: auto;      /* si el contenido es grande, aparece scroll */
        padding: 12px;
        background: #fff;
        border: 1px solid #ccc;
        border-top: 4px solid #005F9E;
        border-radius: 6px;
        box-shadow: 0 4px 10px rgba(0,0,0,0.15);
        z-index: 10060;
      }

      .card.help:hover .card-help-popup {
        display: block;
      }

      .card-help-popup img {
        width: 100%;       /* si quieres que la imagen sea grande dentro del popup */
        height: auto;
        border-radius: 4px;
        margin-bottom: 8px;
      }

      .card-help-popup p {
        margin: 0;
        font-size: 0.9rem;
        line-height: 1.3;
      }

      .grid-container {
        isolation: isolate;
      }

      /* SUBOPCIONES */
      .suboptions {
        display: grid;
        grid-template-columns: repeat(auto-fit,minmax(260px,1fr));
        gap: 1.25rem;
      }

      .sub-card {
        background: var(--card-bg);
        border-radius: var(--radius);
        padding: 1.1rem 1.2rem;
        box-shadow: var(--shadow);
        border-left: 4px solid var(--primary);
        display: flex;
        flex-direction: column;
        gap: 0.4rem;
      }

      .sub-card h3 {
        font-size: 1.02rem;
        color: var(--dark);
      }

      .sub-card p {
        font-size: 0.9rem;
        color: #4a5a6a;
        flex: 1;
      }

      .btn-row {
        margin-top: 0.5rem;
        display: flex;
        flex-wrap: wrap;
        gap: 0.5rem;
      }

      .btn {
        border-radius: 999px;
        border: none;
        padding: 0.5rem 0.9rem;
        font-size: 0.9rem;
        cursor: pointer;
        display: inline-flex;
        align-items: center;
        gap: 0.3rem;
        transition: background 0.15s, transform 0.1s, box-shadow 0.1s;
        box-shadow: 0 2px 6px rgba(0,0,0,0.12);
      }

      .btn-primary {
        background: var(--primary);
        color: white;
      }

      .btn-primary:hover {
        background: #005580;
        transform: translateY(-1px);
      }

      .btn-secondary {
        background: #ecf1f8;
        color: var(--dark);
      }

      .btn-secondary:hover {
        background: #dde5f2;
        transform: translateY(-1px);
      }

      .btn-ghost {
        background: transparent;
        border: 1px solid #c4cfdd;
        box-shadow: none;
      }

      .btn-ghost:hover {
        background: #edf1f8;
      }

      /* OPCION 3: 3 CARDS EN UNA FILA */
      .row-3 {
        display: grid;
        grid-template-columns: repeat(3, minmax(0,1fr));
        gap: 1.25rem;
      }

      /* 1-per-row layout (override) */
      .one-per-row {
        grid-template-columns: 1fr !important;
      }

      @media (max-width: 900px) {
        .row-3 {
          grid-template-columns: repeat(auto-fit,minmax(240px,1fr));
        }
      }

      .sim-card {
        position: relative;
        background: var(--card-bg);
        border-radius: var(--radius);
        overflow: visible;
        min-height: 190px;
        box-shadow: var(--shadow);
        cursor: pointer;
        display: flex;
        flex-direction: column;
        transition: transform 0.12s, box-shadow 0.12s;
      }

      .sim-card:hover {
        transform: translateY(-3px);
        box-shadow: 0 14px 28px rgba(0,0,0,0.12);
      }

      .sim-image {
        flex: 1;
        background-size: cover;
        background-position: center;
        filter: brightness(0.85);
        transition: opacity 0.2s ease-out;
      }

      .sim-overlay {
        position: absolute;
        inset: 0;
        display: flex;
        align-items: flex-end;
        justify-content: center;
        padding: 0.9rem;
        background: linear-gradient(to top, rgba(0,0,0,0.5), rgba(0,0,0,0.1));
        color: white;
        font-weight: 600;
        text-align: center;
        font-size: 0.98rem;
      }

      .sim-help {
        position: absolute;
        inset: 0;
        padding: 1rem;
        display: flex;
        align-items: center;
        justify-content: center;
        text-align: center;
        background: var(--primary-light);
        color: var(--dark);
        opacity: 0;
        transition: opacity 0.2s ease-out;
        font-size: 0.93rem;
        font-weight: 500;
      }

      .sim-card:hover .sim-image,
      .sim-card:hover .sim-overlay {
        opacity: 0;
      }

      .sim-card:hover .sim-help {
        opacity: 1;
      }

      /* VIDEOS */
      .video-wrapper {
        background: var(--card-bg);
        border-radius: var(--radius);
        padding: 1.1rem 1.25rem 1.4rem;
        box-shadow: var(--shadow);
      }

      .video-wrapper h3 {
        margin-bottom: 0.3rem;
      }

      .video-wrapper p {
        font-size: 0.9rem;
        margin-bottom: 0.8rem;
        color: #4a5a6a;
      }

      .video-frame {
        position: relative;
        width: 100%;
        padding-bottom: 56.25%; /* 16:9 */
        border-radius: 10px;
        overflow: hidden;
        background: #000;
      }

      .video-frame iframe {
        position: absolute;
        inset: 0;
        width: 100%;
        height: 100%;
        border: 0;
      }

      /* PEQUE√ëO TOAST PARA ERRORES / ESTADO */
      .toast {
        position: fixed;
        bottom: 1.2rem;
        right: 1.2rem;
        background: #333;
        color: #fff;
        padding: 0.6rem 0.9rem;
        border-radius: 999px;
        font-size: 0.85rem;
        opacity: 0;
        transform: translateY(10px);
        pointer-events: none;
        transition: opacity 0.2s, transform 0.2s;
        z-index: 20;
      }

      .toast.show {
        opacity: 1;
        transform: translateY(0);
        pointer-events: auto;
      }

      /* VIDEOS (dynamic list) */
      /* Video modal */
      .modal-backdrop {
        position: fixed;
        inset: 0;
        background: rgba(0,0,0,0.55);
        display: none;
        align-items: center;
        justify-content: center;
        padding: 1.2rem;
        z-index: 999;
      }

      .modal-backdrop.show {
        display: flex;
      }

      .modal {
        width: min(980px, 96vw);
        background: var(--card-bg);
        border-radius: 16px;
        box-shadow: 0 24px 60px rgba(0,0,0,0.3);
        overflow: visible;
      }

      .modal-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        gap: 0.75rem;
        padding: 0.9rem 1rem;
        border-bottom: 1px solid rgba(0,0,0,0.08);
      }

      .modal-header .modal-title {
        font-weight: 650;
        color: var(--dark);
        font-size: 1rem;
        overflow: hidden;
        white-space: nowrap;
        text-overflow: ellipsis;
      }

      .modal-close {
        border: none;
        background: #ecf1f8;
        color: var(--dark);
        border-radius: 999px;
        padding: 0.45rem 0.75rem;
        cursor: pointer;
      }

      .modal-body {
        position: relative;
        width: 100%;
        padding-bottom: 56.25%; /* 16:9 */
        background: #000;
      }

      .modal-body iframe {
        position: absolute;
        inset: 0;
        width: 100%;
        height: 100%;
        border: 0;
      }

      /* VIDEOS (dynamic list) - vertical cards */
      .videos-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(260px, 1fr));
        gap: 1.25rem;
      }

      .video-card {
        background: var(--card-bg);
        border-radius: var(--radius);
        box-shadow: var(--shadow);
        overflow: hidden;
        display: flex;
        flex-direction: column;
      }

      .video-thumb {
        width: 100%;
        aspect-ratio: 16 / 9;
        background: #000;
        cursor: pointer;
        display: flex;
        align-items: center;
        justify-content: center;
      }

      .video-thumb img {
        width: 100%;
        height: 100%;
        object-fit: cover;
        display: block;
      }

      .video-content {
        padding: 0.9rem 1rem 1rem;
        display: flex;
        flex-direction: column;
        gap: 0.7rem;
      }

      .video-title {
        font-weight: 650;
        color: var(--dark);
        font-size: 1rem;
        line-height: 1.25;
      }

      .video-buttons {
        display: flex;
        flex-wrap: wrap;
        gap: 0.5rem;
      }

      .help-btn {
        background: #ecf1f8;
        color: var(--dark);
      }

      .help-btn:hover {
        background: #dde5f2;
      }

      /* TUTORIALS - vertical cards */
      .tutorials-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(260px, 1fr));
        gap: 1.25rem;
      }

      .tutorial-card {
        background: var(--card-bg);
        border-radius: var(--radius);
        box-shadow: var(--shadow);
        overflow: hidden;
        display: flex;
        flex-direction: column;
      }

      .tutorial-thumb {
        width: 100%;
        aspect-ratio: 16 / 9;
        background: linear-gradient(135deg, var(--primary), #0099cc);
        color: white;
        display: flex;
        align-items: center;
        justify-content: center;
        font-weight: 700;
        letter-spacing: 0.04em;
        cursor: pointer;
      }

      .tutorial-content {
        padding: 0.9rem 1rem 1rem;
        display: flex;
        flex-direction: column;
        gap: 0.7rem;
      }

      .tutorial-title {
        font-weight: 650;
        color: var(--dark);
        font-size: 1rem;
        line-height: 1.25;
      }

      .tutorial-buttons {
        display: flex;
        flex-wrap: wrap;
        gap: 0.5rem;
      }

      /* SEARCH SUGGEST DROPDOWN */
      .search-wrap {
        position: relative;
      }

      .suggest {
        position: absolute;
        top: 100%;
        left: 0;
        right: 0;
        background: var(--card-bg);
        border: 1px solid #ddd;
        border-top: none;
        border-radius: 0 0 8px 8px;
        max-height: 300px;
        overflow-y: auto;
        display: none;
        z-index: 1000;
        box-shadow: 0 4px 12px rgba(0,0,0,0.1);
      }

      .suggest.show {
        display: block;
      }

      .suggest .item {
        padding: 0.75rem 1rem;
        cursor: pointer;
        border-bottom: 1px solid #f0f0f0;
        font-size: 0.9rem;
        color: var(--dark);
        transition: background 0.15s;
      }

      .suggest .item:hover {
        background: var(--primary-light);
      }

      .suggest .item:last-child {
        border-bottom: none;
      }

      /*.-------------de ChatGPT ----------- */
      button.card {
        position: relative;
        display: block;
        border: 0;
        background: transparent;
        padding: 0;
        cursor: pointer;
        z-index: 0;
      }

      button.card:hover {
        z-index: 10;
      }

      </style>
  </head>
  <body>
    <header>
      <div class="header-left">
        <img src="img/ACM_LOGO.png" alt="Logo ACM" class="logo-acm" />
        <a href="https://www.acm-sl.com" target="_blank" rel="noopener noreferrer" class="acmsl-text">ACMSL</a>
        <div>
          <h1 data-i18n="header.title">Wind Turbine Real-Time Simulators, Training & Engineering Tools</h1>
          <p>Reduce Training Costs and Strengthen Your Maintenance Workforce</p>
        </div>
      </div>
      <div class="search-wrap">
        <input id="searchInput" type="text" data-i18n-placeholder="search.placeholder" placeholder="Search‚Ä¶" autocomplete="off" />
        <button id="searchBtn" class="btn btn-secondary" type="button" data-i18n="search.button">Search</button>
        <div id="searchSuggest" class="suggest" role="listbox" aria-label="Search suggestions"></div>
      </div>
      <div style="display:flex;align-items:center;gap:0.5rem">
        <select id="langSelect" aria-label="Language" style="border-radius:999px;padding:0.35rem;">
          <option value="en">EN</option>
          <option value="es">ES</option>
          <option value="fr">FR</option>
          <option value="it">IT</option>
        </select>
        <button class="home-btn" type="button" onclick="goHome()">üè† <span data-i18n="home">Home</span></button>
      </div>
    </header>

    <div id="breadcrumb" class="breadcrumb"></div>

    <main>
      <!-- LANDING: 6 OPCIONES -->
      <section id="landing" class="active" data-breadcrumb="Home">
        <div class="section-header">
          <h2>Select a subject</h2>
          <p>Click on a subject to access the corresponding applications</p>
        </div>

        <div class="grid-6">
          <!-- 1. Introducci√≥n a la Energ√≠a E√≥lica -->
          <button class="card" type="button" data-target="concepts" data-keywords="wind energy,turbine concepts,energy generation, mind map">
            <div class="card-image" style="background-image:url('img/mindmaprecortado.png');"></div>
            <div class="card-title" data-i18n="card.intro.title">Introduction to Wind Turbines concepts</div>
          </button>

          <!-- 2. Wind Farms -->
          <button class="card" type="button" data-target="Wind Farm SCADA">
            <div class="card-image" style="background-image:url('img/ParqueEolico.png');"></div>
            <div class="card-title">Electric Grid and Wind Farms concepts</div>
          </button>

          <!-- 3. Aerogeneradores en Parques E√≥licos -->
          <button class="card" type="button" data-target="opcionSimuladores">
            <div class="card-image" style="background-image:url('img/vista-wt-reducida.png');"></div>
            <div class="card-title">Access to Real-Time Wind Turbine Simulators</div>
          </button>

          <!-- 4. Analysis del Tren de Potencia (hover ayuda) -->
          <button class="card help" type="button" data-target="opcion5">
            <div class="card-image" style="background-image:url('img/powervsrpms-reducido.png');"></div>
            <div class="card-title">Drive Train analysis software</div>
            <div class="card-help-popup">
              <img src="img/OperCurveVarSpeedWTs.jpg" alt="Help image" />
              <p>Program for computing of the <strong>Operational Curve of Variable Speed Wind Turbines</strong> (DFIGs and Full Converter families).</p>
            </div>
          </button>

          <!-- 5. C√°lculos sobre Back-to-Back converters (hover ayuda) -->
          <button class="card help" type="button" data-target="opcion5">
            <div class="card-image" style="background-image:url('img/dfigradar.png');"></div>
            <div class="card-title">Back-to-Back converters of DFIGs</div>
            <div class="card-help-popup">
              <img src="img/dfigb2b.png" alt="Help image" />
              <p>Program to compute the values of the magnetic and electric variables in the Asynchronous Induction Machine in <strong>DFIG Wind Turbines</strong>, assuming it is connected to a <strong>Power Electronics Back-to-Back converter</strong>.</p>
            </div>
          </button>

          <!-- 6. V√≠deos interesantes -->
          <button class="card" type="button" data-target="opcion6">
            <div class="card-image" style="background-image:url('img/CollageImagenesVideos-reducido.png');"></div>
            <div class="card-title">Some significant V√≠deos</div>
          </button>

          <!-- 7. Tutoriales -->
          <button class="card" type="button" data-target="opcionTutoriales">
            <div class="card-image" style="background-image:url('img/AccesoaTutoriales.png');"></div>
            <div class="card-title">Access to the Tutorials</div>
          </button>

          <!-- 8. Guias y experimentos -->
          <button class="card" type="button" data-target="opcionGuias">
            <div class="card-image" style="background-image:url('img/AccesoaGuias-2.png');"></div>
            <div class="card-title"   data-i18n="guided.learning.title">guided.learning.title</div>
          </button>
        </div>
      </section>

      <!-- OPCI√ìN 1: INTRODUCCI√ìN A LA ENERG√çA E√ìLICA -->
      <section id="concepts">
        <div class="section-header">
          <h2 data-i18n="concepts.title">concepts.title</h2>
          <p></p>
        </div>

        <div class="suboptions">
          <!-- 1-1 -->
          <div class="sub-card">
            <h3 data-i18n="concepts.mindmap.h3">concepts.mindmap.h3</h3>
            <p data-i18n="concepts.mindmap.p">This mind-map presents an structural view of the essential technical, operational, and technological aspects of wind energy, serving as a complete reference for planning, training, and decision‚Äëmaking.</p>
            <div class="btn-row">
              <button id ="btnMindMap" class="btn btn-primary" type="button" data-i18n="concepts.mindmap.button">concepts.mindmap.button</button>
            </div>
          </div>

          <!-- 1-2 -->
          <div class="sub-card">
            <h3 data-i18n="concepts.intro.family">concepts.intro.family</h3>
            <p>This tutorial presents views of the most installed families of Wind Turbines, their historical evolution and the typical Production vs Wind Speed curve.</p>
            <div class="btn-row">
            <button id="btnTutorialFamily" class="btn btn-primary" type="button" data-i18n="concepts.intro.textbutton">concepts.intro.textbutton</button>
            </div>
          </div>
        </div>
      </section>

      <!-- ====================== Opcion de Tutoriales ============== -->
      <!-- OPCI√ìN 7: Tutoriales -->
      <section id="opcionTutoriales" data-breadcrumb="Tutorials">
        <div class="section-header">
          <h2>Direct access to the Tutorials</h2>
          <p>The Tutorials are a key component of the product line of ACM SL. They normally are associated to the Real-Time Simulators and Applications, and can be access from whitin them: here you can access them directly.</p>
        </div>

        <div class="suboptions one-per-row">
          <!-- Wind Farm Control Center -->
          <div class="sub-card">
            <h3>Tutorial of the "Wind Farm Control Center/SCADA" Simulator</h3>
            <p>Learn about the Wind Farm components, the electric Substation, the SCADA control and its functionalities, the Meteorological Tower, the communications withe Wind Turbine, the relationship with the Transmission System Operator of the Grid.</p>
            <p>And about the main characteristics of the Electic Grid affecting the operation of the Wind Farm.</p>
            <div class="btn-row">
              <button class="btn btn-primary" type="button" onclick="runAviewer('C:\\ACMSL\\WindFarmSimulator\\Help\\English\\Wind_Farm_Simulator_SCADA\\Introduction.html')">üìñ Open the "Wind Farm Control Center/SCADA" Tutorial</button>
            </div>
          </div>

          <!-- DSAS WT -->
          <div class="sub-card">
            <h3>Tutorial of the "Real-Time Dual Speed Active Stall WT Simulator"</h3>
            <p>In this tutorial you will find the description of:</p>
            <p>* the most common subsystems in a modern WT</p>
            <p>* the description of its working conditions</p>
            <p>* the basis of the asynchronous induction generator</p>
            <div class="btn-row">
              <button class="btn btn-primary" type="button" onclick="runAviewer('C:\\ACMSL\\WindFarmSimulator\\Help\\English\\DSASWTSimulator\\Introduction.html')">üìñ Open the "Real-Time Dual Speed Active-Stall WT Simulator" Tutorial</button>
            </div>
          </div>

          <!-- RRC WT -->
          <div class="sub-card">
            <h3>Tutorial of the "Real-Time Rotor Resistance Controlled WT Simulator"</h3>
            <p>This WT family constitutes an important step in the development of modern WTs, like DFIGs.</p>
            <p>It uses a common characteristic of the Asynchronous Induction Generators to solve the problem of using the Drive Train as an energy storage device to cope with the problems associated with wind gusts.</p>
            <div class="btn-row">
              <button class="btn btn-primary" type="button" onclick="runAviewer('C:\\ACMSL\\WindFarmSimulator\\Help\\English\\RRCWTSimulator\\Introduction.html')">üìñ Open the "Real-Time Rotor Resistance Controlled WT Simulator" Tutorial</button>
            </div>
          </div>

          <!-- DFIG WT -->
          <div class="sub-card">
            <h3>Tutorial of the "Real-Time Doubly-Fed Induction Generator WT Simulator"</h3>
            <p>This WT family constitutes the vast majority of the WTs installed on Wind Farms, world-wide.</p>
            <p>It is a complex production plant that exploit the capabilities of modern Power Electronics.</p>
            <div class="btn-row">
              <button class="btn btn-primary" type="button" onclick="runAviewer('C:\\ACMSL\\WindFarmSimulator\\Help\\English\\DFIGWTSimulator\\Introduction.html')">üìñ Open the "Real-Time Doubly-Fed Induction Generator WT Simulator" Tutorial</button>
            </div>
          </div>

          <!-- LdP WT -->
          <div class="sub-card">
            <h3>Tutorial of the "LdP framework"</h3>
            <p>All the Real-Time simulators of ACMSL are based on the framework <strong>LdP</strong>, developed by ACM SL, that poses unique functionalities for the development of Real-Time Simulators, that, in turn, are based on <strong>Digital Twins</strong></p>
            <p>In this tutorial you have a description of its characteristics.</p>
            <div class="btn-row">
              <button class="btn btn-primary" type="button" onclick="runAviewer('C:\\ACMSL\\WindFarmSimulator\\Help\\English\\LdP_Help\\Introduction.html')">üìñ Open the "Real-Time Doubly-Fed Induction Generator WT Simulator" Tutorial</button>
            </div>
          </div>
        </div>
      </section>

      <section id="opcionGuiaWFSSCADA" data-breadcrumb="Guide SCADA">
        <div class="section-header">
          <h2>Guided exploration of the Wind Farm Control Center/SCADA</h2>
        </div>

        <div class="suboptions one-per-row">
          <div class="sub-button">
            <h3>1 - Basic characteristics of the Electric Grid</h3>
            <div class="btn-row">
              <button class="btn" type="button" onclick="runAviewer('C:\\ACMSL\\WindFarmSimulator\\Help\\English\\Wind_Farm_Simulator_SCADA\\TheControlRoom1.html')">üìñ Open the Tutorial</button>
            </div>
          </div>

          <div class="sub-button">
            <h3>2 - Structure and Functionalitires of a Wind Farm</h3>
            <div class="btn-row">
              <button class="btn" type="button" onclick="runAviewer('C:\\ACMSL\\WindFarmSimulator\\Help\\English\\Wind_Farm_Simulator_SCADA\\StrucutureandFunctionalitiesofaW.html')">üìñ Open the Tutorial</button>
            </div>
          </div>

          <div class="sub-button">
            <h3>3 - Control of Wind Turbine</h3>
            <p>Each Wind Turbine operates as an <em>Autonomous Independent Production Unit</em> and is capable of generating electrical power without relying on any external sensing devices, provided that the required operating conditions are met.</p>
            <p>They admit remote command for starting production (<em>cut in</em>), stoping production (<em>cut out</em>), and (modern ones) for fixing the maximum production.</p>
            <div class="btn-row">
              <button class="btn" type="button" onclick="runAviewer('C:\\ACMSL\\WindFarmSimulator\\Help\\English\\Wind_Farm_Simulator_SCADA\\ControlofaWindTurbine.html')">üìñ Open the Tutorial</button>
            </div>
          </div>

          <div class="sub-button">
            <h3>4 - Connection of the Wind Farm with the Grid</h3>
            <p>The Wind Turbines are connected with the Substation through with Medium Voltage power cables.</p>
            <p>In on-shore Wind Farms the Substation is connected to the Grid through a High Voltage AC line (&gt; 100 KV)</p>
            <p>In off-shore Wind Farms this connection may be with very high voltage DC cables.</p>
            <div class="btn-row">
              <button class="btn" type="button" onclick="runAviewer('C:\\ACMSL\\WindFarmSimulator\\Help\\English\\Wind_Farm_Simulator_SCADA\\UnifilarschematicoftheSubstation.html')">üìñ Open the Tutorial</button>
            </div>
          </div>

          <div class="sub-button">
            <h3>5 - Grid Codes of the Wind Turbines</h3>
            <p>Each national Transmission System Operator (TSO) defines a mandatory Grid Code specifying the technical requirements that wind turbines must comply with when connected to the electrical network. These requirements are established to ensure system stability and continuity of supply (i.e., preventing unintended outages). The applicable Grid Code varies from one country to another.</p>
            <div class="btn-row">
              <button class="btn" type="button" onclick="runAviewer('C:\\ACMSL\\WindFarmSimulator\\Help\\English\\Wind_Farm_Simulator_SCADA\\GridCodes.html')">üìñ Open the Tutorial</button>
              <button class="btn" type="button" onclick="runAviewer('C:\\ACMSL\\WindFarmSimulator\\Help\\English\\DFIGWTSimulator\\GridDescriptionGridCodes.html')">üìñ Open the Tutorial</button>
            </div>
          </div>
        </div>
      </section>

      <!-- OPCI√ìN 8: Guias y experimentos -->
      <section id="opcionGuias" data-breadcrumb="Guides">
        <div class="section-header">
          <h2>Access to Guided learning and suggested Experiments</h2>
          <p>You will find in this section sets of Guided tours around the Tutorials, as well as Suggested Experiments described in the Tutorials</p>
        </div>

        <div class="suboptions">
          <div class="sub-card">
            <h3>Suggested Experiments - 1</h3>
            <div class="btn-row">
              <p>In this Tutorial there are a list of experiments that illustrate key concepts, and comparisons between types of wind turbines families</p>
              <button class="btn btn-primary" type="button" onclick="runAviewer('C:\\ACMSL\\WindFarmSimulator\\Help\\English\\Experiments\\Introduction.html')">üìñ Open the "Experiments" Tutorial</button>
            </div>
          </div>

          <div class="sub-card">
            <h3>Guided learning for the Wind Farm Control Center/SCADA</h3>
            <div class="card-text">
              <p>The items in the next links provide an ordered reading of the Tutorial of the Wind Farm Control Center/SCADA, following</p>
              <button class="card" type="button" data-target="opcionGuiaWFSSCADA">üìñ Open the Guide</button>
            </div>
          </div>
        </div>
      </section>

      <!-- OPCI√ìN 2: PARQUES E√ìLICOS -->
      <section id="Wind Farm SCADA" data-breadcrumb="Wind Farm SCADA">
        <div class="section-header">
          <h2>The Wind Farms and the Electric Grid</h2>
          <p>Wind farms serve as the fundamental production units, supplying their generated power directly to the Transmission Tetwork of the Electric Grid.</p>
        </div>

        <div class="suboptions">
          <div class="sub-card">
            <h3>ACMSL "Wind Farm Control Center/SCADA" Simulator</h3>
            <p>This simulator, together with its Tutorial, enables users to understand the Wind Farm components, their operational roles, and the way they interact with one another and with the Electric Grid.</p>
            <div class="btn-row">
              <button class="btn btn-primary" type="button" onclick="runAldp('WFSSCADAr12.conf','English')">‚ñ∂ Run the "Wind Farm Control Center/SCADA" Simulator</button>
            </div>
          </div>

          <div class="sub-card">
            <h3>Access to the "Wind Farm Control Center/SCADA" Simulator" Tutorial</h3>
            <p>While the Wind Farm Control Center/SCADA Simulator includes built‚Äëin access to its tutorial, this option lets users open the tutorial separately, without launching the simulator itself.</p>
            <div class="btn-row">
              <button class="btn btn-primary" type="button" onclick="runAviewer('C:\\ACMSL\\WindFarmSimulator\\Help\\English\\Wind_Farm_Simulator_SCADA\\Introduction.html')">üìñ Open the "Wind Farm Control Center/SCADA" Simulator's Tutorial</button>
            </div>
          </div>
        </div>
      </section>

      <!-- OPCI√ìN 3: AEROGENERADORES EN PARQUES E√ìLICOS -->
      <section id="opcionSimuladores" data-breadcrumb="Simulators">
        <div class="section-header">
          <h2>Families of Wind Turbines in Wind Farms</h2>
          <p>You have a introductory presentation in <a href="acmsl://viewertutorial%20-h433A5C41434D534C5C57696E644661726D53696D756C61746F725C636F6E665C547261696E696E6720696E20496E647573747269616C2061737065637473206F662057696E6420456E657267795C57696E6454757262696E6546616D696C6965732E68746D6C" target="_blank" rel="noopener noreferrer">Families of Wind Turbines</a></p>
        </div>

        <div class="row-3">
          <button class="card help" type="button" onclick="runAldp('dsasr12.conf','English')">
            <div class="card-image" style="background-image:url('img/hawt-generico-reducido.png');"></div>
            <div class="card-title">For the Squirrel Cage generator, Active Stall Controlled, Dual Speed family of WTs</div>
            <div class="card-help-popup">
              <img src="img/hawt-generico.png" alt="Help image" />
              <p>Real-Time Simulator for the family of WTs with variable Pitch blades, and control using <strong>Active-Stall principle</strong>, and <strong>two operative Hub rotational speeds</strong>.</p>
            </div>
          </button>

          <button class="card help" type="button" onclick="runAldp('rrcr12.conf','English')">
            <div class="card-image" style="background-image:url('img/rrc-reducido.png');"></div>
            <div class="card-title">For the Rotor Resistance Controlled family of WTs</div>
            <div class="card-help-popup">
              <img src="img/rrc.png" alt="Help image" />
              <p>Real-Time Simulator for the family of WTs that implements control through two mechanism: the Blades Pitch and the <strong>Winding Rotor Resistance of the asynchronous induction generator</strong>.</p>
            </div>
          </button>

          <button class="card help" type="button" onclick="runAldp('dfigr12.conf','English')">
            <div class="card-image" style="background-image:url('img/dfigr12.png');"></div>
            <div class="card-title">For the Doubly-Fed Induction Generator (DFIG)family of WTs</div>
            <div class="card-help-popup">
              <img src="img/dfigr12-normal.png" alt="Help image" />
              <p>Real-Time Simulator for the family of DFIG WTs including the simulation of the Power Electronics <strong>Back-to-Back converter</strong>.</p>
            </div>
          </button>
        </div>
      </section>

      <!-- OPCI√ìN 4: AN√ÅLISIS DEL TREN DE POTENCIA -->
      <section id="opcion4" data-breadcrumb="Drive Train">
        <div class="section-header">
          <h2>On the Wind Turbine Drivetrain</h2>
          <p>Documentation about the Drive Train, and access to the tool for designing and for studiying its Operational Curve (<em>Blade rpms versus Wind Speed</em>)</p>
        </div>

        <div class="sub-card">
          <h3>Acces to the National Renewable Energy Laboratory (NREL) documentation</h3>
          <p>NREL published in March 2008 this reference paper: <strong>"Advanced Control Design for Wind Turbines Part I: Control Design, Implementation, and Initial Test - Part I: Control Design, Implementation, and Initial Tests"</strong>.</p>
          <p>It contains the description of algorithms required for designing Drive Trains that extract the maximum power from the existing wind.</p>
          <div class="btn-row">
            <button class="btn btn-primary" type="button" onclick="runAfile('https://docs.nrel.gov/docs/fy08osti/42437.pdf')">üìñ Acces to the paper</button>
          </div>
        </div>

        <div class="sub-card">
          <h3>Operational Curve of Variable Speed Wind Turbines</h3>
          <p>To get the maxmimum power from the existing wind speed, a technique known as <strong>Maximum Power Point Tracking</strong> algorithm (or <strong>MPPT</strong>) Blades must rotated with a velocity proportional to the Wind Speed.</p>
          <p>This applications permits the evaluation of algorithms that must be implemented to achieve it.</p>
          <p>It is an engineering tool designed to analyze and define the operating conditions of a wind turbine DriveTrain based on blade type, blade length, and its coupling with the electrical generator, including synchronous speed and the selected gearbox ratio.</p>
          <div class="btn-row">
            <button class="btn btn-primary" type="button" onclick="runAopercurv('English')">‚ñ∂ Execute 'Operational Curve of Variable Speed Wind Turbines'</button>
          </div>
        </div>
      </section>

      <!-- OPCI√ìN 5: C√ÅLCULOS SOBRE BACK-TO-BACK CONVERTERS -->
      <section id="opcion5" data-breadcrumb="Back-to-Back">
        <div class="section-header">
          <h2>Power Electronics Back-to-Back converters</h2>
          <p>Program to compute the demand on Back-to-Back converters when connected to a Asynchronous Induction Machine, in DFIG Wind Turbines.</p>
        </div>

        <div class="sub-card">
          <h3>Run the application "DFIGB2B"</h3>
          <p>This program computes all the magnetic and electric variable on the Asynchronous Induction Machine used of the Doubly Fed Induction Generator family of Wind Turbine, and also the demand placed on the Back-to-&gt;Back converter. Ideal for post-morten analysis of these converters.</p>
          <p>This <a href="https://youtu.be/AfkW0Qvy8AI" target="_blank" rel="noopener noreferrer">video</a> contains a brief explanation.</p>
          <div class="btn-row">
            <button class="btn btn-primary" type="button" onclick="runAdfig('DFIGB2B','DFIGB2B_ABB_1500KW_50Hz.conf')">‚ñ∂ Run DFIGB2B</button>
          </div>
        </div>
      </section>

      <!-- OPTION 6: INTERESTING VIDEOS -->
      <section id="opcion6" data-breadcrumb="Videos">
        <div class="section-header">
          <h2>Wind Turbine related videos</h2>
          <p>Select a video to watch. Titles come from <code>Videos.txt</code>.</p>
        </div>

        <div id="videos-container" class="videos-grid"></div>
      </section>
    </main>

    <div id="toast" class="toast"></div>

    <!-- Search keywords (not visible, only for search) -->
    <script id="searchKeywords" type="application/json">
      [
        { "keywords": ["yaw system", "yaw drive", "yaw motor"], "section": "Wind Farm SCADA" },
        { "keywords": ["active stall", "stall control", "pitchless"], "section": "opcion3" },
        { "keywords": ["scada", "wind farm scada", "supervisory control"], "section": "tutorials" },
        { "keywords": ["gearbox", "planetary stage", "epicyclic"], "section": "opcion4" }
      ]
    </script>

    <!-- Inline translations fallback for file:// usage -->
    <script id="i18n-en" type="application/json">
    {
      "header.title": "Wind Turbine Real-Time Simulators, Training & Engineering Tools",
      "home": "Home",
      "search.placeholder": "Search‚Ä¶",
      "search.button": "Search",
      "breadcrumb.landing": "Home",
      "breadcrumb.concepts": "Wind Energy Concepts",
      "breadcrumb.Wind Farm SCADA": "Wind Farm SCADA",
      "breadcrumb.opcionSimuladores": "Simulators",
      "breadcrumb.opcionTutoriales": "Tutorials",
      "breadcrumb.opcionGuias": "Guides",
      "breadcrumb.opcion6": "Videos",
      "card.intro.title": "Introduction to Wind Turbines concepts"
    }
    </script>
    <script id="i18n-es" type="application/json">
    {
      "header.title": "Simuladores y Herramientas de Aerogeneradores en Tiempo Real",
  "header.subtitle": "Reduce los costes de formaci√≥n y refuerza tu equipo de mantenimiento",
  "search.placeholder": "Buscar‚Ä¶",
  "search.button": "Buscar",
  "home": "Inicio",
  "breadcrumb.landing": "Inicio",
  "breadcrumb.concepts": "Conceptos de Energ√≠a E√≥lica",
  "breadcrumb.Wind Farm SCADA": "Parque E√≥lico SCADA",
  "breadcrumb.opcionSimuladores": "Simuladores",
  "breadcrumb.opcionTutoriales": "Tutoriales",
  "breadcrumb.opcionGuias": "Gu√≠as",
  "breadcrumb.opcion6": "V√≠deos",
  "breadcrumb.opcion4": "Tren de Potencia",
  "breadcrumb.opcion5": "Back-to-Back converter",
  "breadcrumb.opcionGuiaWFSSCADA": "Gu√≠a SCADA",
  "landing.title": "Selecciona un tema",
  "landing.subtitle": "Haz clic en un tema para acceder a las aplicaciones correspondientes",
  "card.intro.title": "Introducci√≥n a los conceptos de Aerogeneradores",
  "card.grid.title2": "Conceptos de Red El√©ctrica y Parques E√≥licos",
  "card.grid.title3": "Acceso a los Simuladores de Aerogeneradores en Tiempo Real",
  "card.grid.title4": "Software de an√°lisis del Tren de Potencia",
  "card.grid.title5": "Convertidores Back-to-Back de DFIGs",
  "card.grid.title6": "Algunos v√≠deos significativos",
  "card.grid.title7": "Acceso a los Tutoriales",
  "card.grid.title8": "Aprendizaje guiado y experimentos sugeridos",
  "concepts.title": "Introduci√≥n a conceptos de Energ√≠a E√≥lica",
  "concepts.intro.mindmap": "Mapa mental con los conceptos clave en Energia E√≥lica",
  "concepts.intro.family": "Introducci√≥n a las familias de Aerogeneradores y su evoluci√≥n",
  "concepts.intro.textbutton": "‚ñ∂ Visualizar el Tutorial",
  "concepts.intro.mindmap.button": "‚ñ∂ Abre el Mapa Mental"    }
    </script>

    <!-- Embedded videos catalog (Option C: offline, no fetch). Replace the contents with your Videos.txt XML -->
    <script id="videosXml" type="text/plain">
<Root>
  <Video>
    <Exec>https://youtu.be/rzArDywPrBY</Exec>
    <Title>Transparent view of a Nacelle</Title>
    <Help>This video provides a travelling view of a nacelle, with transparent walls</Help>
  </Video>
  <Video>
    <Exec>https://youtu.be/8wK1qmRv_l8</Exec>
    <Title>Guided visit to a Wind Turbine</Title>
    <Help></Help>
  </Video>
  <Video>
    <Exec>https://youtu.be/tUse6mSeU-I</Exec>
    <Title>Virtual Wind Farm Tour Ep 5: The Nacelle</Title>
    <Help>This video the preparation stage of an intervention on a Wind Turbine</Help>
  </Video>
  <Video>
    <Exec>https://youtu.be/ZjvBbKqMvEM</Exec>
    <Title>Key concepts of Wind Energy and Wind Turbines</Title>
    <Help>This video presents a short presentation of the basics concepts on Wind Turbines</Help>
  </Video>
  <Video>
    <Exec>https://youtu.be/0bZFwWSccGQ</Exec>
    <Title>Description of one Wind Turbine simulator</Title>
    <Help>This video contains a short introduction to the Simulator for the Wind Turbine with Active Stall control.</Help>
  </Video>
  <Video>
    <Exec>https://youtu.be/UOjPvVjseVc</Exec>
    <Title>START and STOP operations of a Wind Turbine</Title>
    <Help>In this video you can observe the evolution of the Wind Turbine of the Active Stall type, with squirrel cage electric Generator directly connected to the Grid, during two basic operations: START (from disconnected from the Grid to connection, and start production - <i>cutin</i>-), and STOP (from production state to stop state - <i>cutout</i>).</Help>
  </Video>
  <Video>
    <Exec>https://youtu.be/iNcIchrkLNM</Exec>
    <Title>Evolution of the internal signals of a <strong>DFIG</strong> Wind Turbine <strong>wth windgusts</strong></Title>
    <Help>This video presents a detailed analysis of the evolution of several key signals inside a DFIG. <p>It also presents the case of windgusts.</p></Help>
  </Video>
  <Video>
    <Exec>https://youtu.be/zwhvSf7LGbg</Exec>
    <Title>Evolution  of a DFIG during a windgust with problems in the Pitch system - High Wind Speed</Title>
    <Help>This video shows the evolution of the Drive Train  of a 1.5 MW Wind Turbine, with high wind speed, under two different operational conditions: a) normal, and b) with problems in the Pitch system</Help>
  </Video>
  <Video>
    <Exec>https://youtu.be/6pmcnACDfq0</Exec>
    <Title>Evolution of a DFIG Drive Train with wind gusts, and problems in the Pitch System - Low Wind Speed</Title>
    <Help>This video shows the evolution of the Drive Train  of a 1.5 MW Wind Turbine, with low wind speed, under two different operational conditional conditions: a) normal, and b) with problems in the Pitch system</Help>
  </Video>
  <Video>
    <Exec>https://youtu.be/OcR_WvUvN_M</Exec>
    <Title>Management of incidences</Title>
    <Help><i>Incidences</i> are a key concept in Wind Turbines: Wind Turbines are <i>Production Plants</i>, designed to operate in stand-alone mode, adapting their behavior to the changing conditions (wind speed, wind direction, failures in the Grid, internal failures, etc.) <p>Whenever a subsystem is not working properly, or some variable goes out of range, the Wind Turbine's Controller supplies information (incidence) that can be used to analyse the actual condition of the Wind Turbine.</p> <p>Familiarity with the possible <i>incidences</i> in a Wind Turbine <strong>is a must for anyone involved in its Operation and Maintenance</strong>.</p></Help>
  </Video>
  <Video>
    <Exec>https://www.youtube.com/watch?v=84BeVq2Jm88</Exec>
    <Title>Erection of a Wind Turbine - MidAmerican Energy -</Title>
    <Help></Help>
  </Video>
  <Video>
    <Exec>https://youtu.be/whTfACs0Og8?t=8</Exec>
    <Title>Use of WindFarmSimulator suite in Minnesota West Technical College</Title>
    <Help>This video by West Technical College presents their installations for Training in Wind Turbine technologies. It shows our WindFarmSimulator in use.</Help>
  </Video>
  <Video>
    <Exec>https://www.youtube.com/watch?v=7EQa-WZ9c3g</Exec>
    <Title>Construction of Wind Turbine subsystems</Title>
    <Help>Videos showing the construction of different subsystems of a Wind Turbine, notably the Yaw system in the Nacelle.</Help>
  </Video>
  <Video>
    <Exec>https://www.youtube.com/watch?v=THf6svHoqaA</Exec>
    <Title>Visit inside a Wind Turbine</Title>
    <Help></Help>
  </Video>
  <Video>
    <Exec>https://youtu.be/Y5T5ZhJQr2o?t=147</Exec>
    <Image>img/stall-vs-pitch-control.png</Image>
    <Title>Wind Turbine Aerodynamics: Stall vs Pitch Regulation</Title>
    <Help>This video shows the difference between the physical principles behind the two most used methods for controlling the intake of power from the wind</Help>
  </Video>
  <Video>
    <Exec>https://youtu.be/rzArDywPrBY</Exec>
    <Title>Transparent view of a Nacelle</Title>
    <Help>This video provides a travelling view of a nacelle, with transparent walls</Help>
  </Video>
  <Video>
    <Exec>https://www.youtube.com/watch?v=ARd-Om2VyiE</Exec>
    <Title>How a Planetary stage works</Title>
    <Help>The Gearbox of a Wind Turbine have a speed transformation among its axis in the range of 1:60 to 1:125, obtained using several stages. <p>Often the first one is a Planetary stage, connected to the Hub.</p></Help>
  </Video>
  <Video>
    <Exec>https://youtu.be/1-2UVzTvhjc</Exec>
    <Title>Aerodynamic stop during Cut Out of a fixed-pitch Wind Turbine</Title>
    <Help></Help>
  </Video>
  <Video>
    <Exec>https://www.youtube.com/shorts/ghUmhOM81ZY?feature=share</Exec>
    <Image>img/VistaInternaTorreDesplazada.png</Image>
    <Title>Movement of the Tower with high wind, from inside</Title>
    <Help></Help>
  </Video>
  <Video>
    <Exec>https://1drv.ms/v/s!AsEAQ7Uim-DCrchZoQrsXJ9Zq0WcFA?e=qQFMQR</Exec>
    <Image>img/wind-tunnel-experiments-reducido.png</Image>
    <Title>Wind Tunnel Experiments</Title>
    <Help></Help>
  </Video>
</Root>
    </script>
    <script>
            // Detectar par√°metro cl en la URL
            function getUrlClParam() {
              const params = new URLSearchParams(window.location.search);
              const cl = params.get('cl');
              if (cl && /^[a-zA-Z0-9_-]+$/.test(cl)) {
                return cl;
              }
              return null;
            }

            // Renderizar los botones de la landing page desde un array de config
            function renderLandingButtons(config) {
              const grid = document.querySelector('#landing .grid-6');
              if (!grid) return;
              // Si el config tiene 'buttons', usarlo, si no, asumir que es array
              const buttons = Array.isArray(config) ? config : config.buttons;
              grid.innerHTML = '';
              buttons.forEach(btn => {
                const button = document.createElement('button');
                button.className = 'card' + (btn.helpText ? ' help' : '');
                button.type = 'button';
                button.setAttribute('data-target', btn.target);
                if (btn.keywords) button.setAttribute('data-keywords', btn.keywords);
                // Imagen
                const imgDiv = document.createElement('div');
                imgDiv.className = 'card-image';
                imgDiv.style.backgroundImage = `url('${btn.image}')`;
                button.appendChild(imgDiv);
                // T√≠tulo
                const titleDiv = document.createElement('div');
                titleDiv.className = 'card-title';
                if (btn.i18n) titleDiv.setAttribute('data-i18n', btn.i18n);
                titleDiv.textContent = btn.title;
                button.appendChild(titleDiv);
                // Ayuda
                if (btn.helpText) {
                  const helpDiv = document.createElement('div');
                  helpDiv.className = 'card-help-popup';
                  if (btn.helpImage) {
                    const img = document.createElement('img');
                    img.src = btn.helpImage;
                    img.alt = 'Help image';
                    helpDiv.appendChild(img);
                  }
                  const p = document.createElement('p');
                  p.innerHTML = btn.helpText;
                  helpDiv.appendChild(p);
                  button.appendChild(helpDiv);
                }
                grid.appendChild(button);
              });
              // Reasignar eventos de navegaci√≥n
              document.querySelectorAll('.card[data-target]').forEach(card => {
                card.addEventListener('click', () => {
                  const target = card.getAttribute('data-target');
                  showSection(target);
                });
              });
              // Si el config tiene header.title o header.subtitle, actualizarlos
              if (config.header) {
                if (config.header.title) {
                  const h1 = document.querySelector('h1[data-i18n="header.title"]');
                  if (h1) h1.textContent = config.header.title;
                }
                if (config.header.subtitle) {
                  const p = document.querySelector('h1[data-i18n="header.title"] + p');
                  if (p) p.textContent = config.header.subtitle;
                }
              } else {
                if (config["header.title"]) {
                  const h1 = document.querySelector('h1[data-i18n="header.title"]');
                  if (h1) h1.textContent = config["header.title"];
                }
                if (config["header.subtitle"]) {
                  const p = document.querySelector('h1[data-i18n="header.title"] + p');
                  if (p) p.textContent = config["header.subtitle"];
                }
              }
            }
      // Detectar par√°metro lang en la URL
      function getUrlLangParam() {
        const params = new URLSearchParams(window.location.search);
        const lang = params.get('lang');
        if (lang && ['en','es','fr','it'].includes(lang.toLowerCase())) {
          return lang.toLowerCase();
        }
        return null;
      }
/**
 * Asigna la funci√≥n y los par√°metros traducidos al onclick de un bot√≥n
 * @param {string} btnId - El id del bot√≥n
 * @param {string} fn - 'runAviewer' o 'runAldp'
 * @param {string|Array} i18nPathKeys - Clave(s) i18n para los par√°metros
 */
function setActionButton(btnId, fn, i18nPathKeys) {
  const btn = document.getElementById(btnId);
  if (!btn) return;
  btn.onclick = function() {
    if (fn === 'runAviewer') {
      runAviewer(t(i18nPathKeys));
    } else if (fn === 'runAldp' && Array.isArray(i18nPathKeys) && i18nPathKeys.length === 2) {
      runAldp(t(i18nPathKeys[0]), t(i18nPathKeys[1]));
    } else if (fn === 'runAfile') {
      runAfile(t(i18nPathKeys));
    }

}

}

document.addEventListener('DOMContentLoaded', function() {
  setActionButton('btnTutorialFamily', 'runAfile', 'tutorial.family.path');

  setActionButton('btnMindMap', 'runAfile', 'mindmap.windenergy.path');

  setActionButton('btnTutorialWFSCADA', 'runAviewer', 'tutorial.wfscada.path');

  setActionButton('btnTutorialDSAS', 'runAviewer', 'tutorial.dsas.path');

  setActionButton('btnTutorialRRC', 'runAviewer', 'tutorial.rrc.path');

  setActionButton('btnTutorialDFIG', 'runAviewer', 'tutorial.dfig.path');
});
      
    </script>
    <script>
      <!-- Navigation between "pages" (sections) -->
      let _navStack = [];
      let _currentSection = "landing";

      function showSection(id, pushHistory = true) {
        document.querySelectorAll('section').forEach(sec => {
          if (sec.id === id) {
            sec.classList.add('active');
          } else {
            sec.classList.remove('active');
          }
        });

        if (pushHistory && id !== _currentSection) {
          _navStack.push(_currentSection);
          _currentSection = id;
        } else if (pushHistory) {
          // id === _currentSection, no hacer nada
          return;
        } else {
          _currentSection = id;
        }

        // Limpiar el stack si vamos a landing
        if (id === "landing") {
          _navStack = [];
        }

        renderBreadcrumb([..._navStack, _currentSection]);
      }


      function getBreadcrumbLabel(sectionId) {
      const el = document.getElementById(sectionId);
      return el?.dataset?.breadcrumb || sectionId;
      }

      function renderBreadcrumb(stack) {
        const bc = document.getElementById("breadcrumb");
        if (!bc) return;

        bc.innerHTML = "";

        // No mostrar breadcrumb en la p√°gina de inicio
        if (stack.length === 1 && stack[0] === "landing") {
          return;
        }

        stack.forEach((secId, i) => {
          const span = document.createElement("span");
          const i18nKey = "breadcrumb." + secId;
          span.setAttribute("data-i18n", i18nKey);
          span.textContent = getBreadcrumbLabel(secId);

          if (i < stack.length - 1) {
            span.className = "bc-link";
            span.onclick = () => navigateToBreadcrumb(secId);
          } else {
            span.className = "bc-current";
          }

          bc.appendChild(span);
          if (i < stack.length - 1) bc.append(" ‚Ä∫ ");
        });
      }

      function navigateToBreadcrumb(targetSection) {
        // Encontrar el √≠ndice de la secci√≥n en el stack
        const index = _navStack.indexOf(targetSection);
        if (index !== -1) {
          // Recortar el stack hasta ese punto
          _navStack = _navStack.slice(0, index);
        } else {
          // Si no est√° en el stack, limpiar el stack (caso de landing)
          _navStack = [];
        }
        
        // Actualizar la secci√≥n actual
        _currentSection = targetSection;
        
        // Actualizar la vista visible
        document.querySelectorAll('section').forEach(sec => {
          if (sec.id === targetSection) {
            sec.classList.add('active');
          } else {
            sec.classList.remove('active');
          }
        });
        
        // Regenerar el breadcrumb
        renderBreadcrumb([..._navStack, _currentSection]);
      }

      function goBack() {
        if (!_navStack.length) {
          _currentSection = "landing";
          showSection("landing", false);
          return;
        }
        const prev = _navStack.pop();
        _currentSection = prev;
        showSection(prev, false);
      }

      function goHome(){
        _navStack = [];
        _currentSection = "landing";
        showSection("landing", false);
        // Limpiar el breadcrumb expl√≠citamente
        const bc = document.getElementById("breadcrumb");
        if (bc) bc.innerHTML = "";
      }

      document.querySelectorAll('.card[data-target]').forEach(card => {
        card.addEventListener('click', () => {
          const target = card.getAttribute('data-target');
          showSection(target);
        });
      });

      function showToast(msg, type = 'info') {
        const toast = document.getElementById('toast');
        toast.textContent = msg;
        toast.style.background = type === 'error' ? '#c0392b' : type === 'success' ? '#00a878' : '#333';
        toast.classList.add('show');
        setTimeout(() => toast.classList.remove('show'), 3000);
      }

      function _acmslEnc(s) { return String(s ?? "").replace(/ /g, "%20"); }

      function _toHex(str) {
        let out = "";
        const s = String(str ?? "");
        for (let i = 0; i < s.length; i++) {
          out += s.charCodeAt(i).toString(16).toUpperCase().padStart(2, "0");
        }
        return out;
      }

      function runAldp(param1, param2) {
        const comando = "acmsl://ldp%20-c%20" + _acmslEnc(param1) + "%20-l%20" + _acmslEnc(param2);
        window.location.href = comando;
      }

      function runAopercurv(param1) {
        const comando = "acmsl://operationalcurvevswt%20-v%20-name%20" + param1;
        window.location.href = comando;
      }

      function runAdfig(nombreDeLaInstancia, fichConfiguracion) {
        const comando = "acmsl://dfigb2b%20-v%20-name%20" + nombreDeLaInstancia + "%20-conf%20" + fichConfiguracion;
        window.location.href = comando;
      }

      function runAviewer(param1) {
        const comandoHex = _toHex(param1);
        const comando = "acmsl://viewertutorial%20-n%20-h" + comandoHex;
        window.location.href = comando;
      }

      function runAfile(param1) {
        const comandoHex = _toHex(param1);
        const comando = "acmsl://file%20-h" + comandoHex;
        window.location.href = comando;
      }

      function abrirGuiaSCADA() { window.location.href = 'Guia_Simulator_WFS_SCADA_Parque_Eolico/index.html'; }
      function abrirVideoEnVentana() { const urlVideo = 'https://www.youtube.com/watch?v=dQw4w9WgXcQ'; window.open(urlVideo, '_blank', 'noopener'); }

      let _videosLoaded = false;

      function _extractYouTubeId(url) {
        try {
          const u = new URL(url);
          if (u.hostname.includes('youtu.be')) return u.pathname.replace('/', '');
          if (u.hostname.includes('youtube.com')) return u.searchParams.get('v');
        } catch (e) {}
        return null;
      }

      function _thumbFromUrl(url) {
        const yt = _extractYouTubeId(url);
        if (yt) return "https://img.youtube.com/vi/" + yt + "/hqdefault.jpg";
        return "BannerVistaMolinos.png";
      }

      function _embedUrl(url) {
        const yt = _extractYouTubeId(url);
        if (yt) return "https://www.youtube.com/embed/" + yt;
        return url;
      }

      async function initVideosOnce() {
        if (_videosLoaded) return;
        _videosLoaded = true;
        const container = document.getElementById('videos-container');
        if (!container) return;
        container.innerHTML = '<div class="video-wrapper"><h3>Loading videos‚Ä¶</h3><p>Please wait.</p></div>';

        // Detectar idioma
        let lang = (localStorage.getItem('lang') || (navigator.language||'en').split('-')[0] || 'en').toLowerCase();
        if (lang !== 'es' && lang !== 'en') lang = 'en';
        const xmlUrl = `videos-${lang}.xml`;
        let xmlText = '';
        let loadedExternally = false;
        try {
          const res = await fetch(xmlUrl);
          if (res.ok) {
            xmlText = await res.text();
            loadedExternally = true;
          }
        } catch (e) {
          // Ignorar error, se usar√° inline
        }
        if (!xmlText) {
          // Fallback: usar bloque inline
          const xmlHolder = document.getElementById('videosXml');
          xmlText = (xmlHolder ? xmlHolder.textContent : '').trim();
        }
        if (!xmlText) {
          container.innerHTML = '<div class="video-wrapper"><h3>No videos found</h3><p>Check that Videos.txt contains <code>&lt;Video&gt;</code> entries.</p></div>';
          return;
        }
        let doc;
        try {
          doc = new DOMParser().parseFromString(xmlText, 'text/xml');
        } catch (err) {
          container.innerHTML = '<div class="video-wrapper"><h3>Cannot parse videos XML</h3><p>Check the XML format.</p></div>';
          return;
        }
        const options = Array.from(doc.getElementsByTagName('Video'));
        const legacyOptions = Array.from(doc.getElementsByTagName('Option'));
        const itemsAll = options.length ? options : legacyOptions;
        if (!itemsAll.length) {
          container.innerHTML = '<div class="video-wrapper"><h3>No videos found</h3><p>Check that Videos.txt contains <code>&lt;Video&gt;</code> entries.</p></div>';
          return;
        }
        function innerXml(node) {
          if (!node) return '';
          let s = '';
          node.childNodes.forEach(ch => {
            if (ch.nodeType === Node.TEXT_NODE) s += ch.textContent;
            else if (ch.nodeType === Node.ELEMENT_NODE) s += ch.outerHTML;
          });
          return s.trim();
        }
        const seen = new Set();
        container.innerHTML = '';
        itemsAll.forEach(opt => {
          const execNode = opt.getElementsByTagName('Exec')[0];
          const imgAlternativaNode = opt.getElementsByTagName('Image')[0];
          const titleNode = opt.getElementsByTagName('Title')[0];
          const helpNode = opt.getElementsByTagName('Help')[0];
          const exec = (execNode ? execNode.textContent : '').trim();
          const imgAlternativa = (imgAlternativaNode ? imgAlternativaNode.textContent: '').trim();
          const title = (titleNode ? titleNode.textContent : 'Video').trim();
          const helpHtml = innerXml(helpNode);
          if (!exec) return;
          const key = exec + '|' + title;
          if (seen.has(key)) return;
          seen.add(key);
          const card = document.createElement('div');
          card.className = 'video-card';
          const thumb = document.createElement('div');
          thumb.className = 'video-thumb';
          thumb.title = 'Open video';
          if (imgAlternativa) thumb.innerHTML = '<img alt="" src="' + imgAlternativa + '">';
          else thumb.innerHTML = '<img alt="" src="' + _thumbFromUrl(exec) + '">';
          thumb.addEventListener('click', () => window.open(exec, '_blank', 'noopener'));
          const content = document.createElement('div');
          content.className = 'video-content';
          const t = document.createElement('div');
          t.className = 'video-title';
          t.textContent = title;
          const buttons = document.createElement('div');
          buttons.className = 'video-buttons';
          const openBtn = document.createElement('button');
          openBtn.className = 'btn btn-primary';
          openBtn.type = 'button';
          openBtn.textContent = '‚ñ∂ Open';
          openBtn.addEventListener('click', () => window.open(exec, '_blank', 'noopener'));
          const helpBtn = document.createElement('button');
          helpBtn.className = 'btn help-btn';
          helpBtn.type = 'button';
          helpBtn.textContent = '‚Ñπ Help';
          helpBtn.disabled = !helpHtml;
          helpBtn.addEventListener('click', () => openHelpModal(title, helpHtml));
          buttons.appendChild(openBtn);
          buttons.appendChild(helpBtn);
          content.appendChild(t);
          content.appendChild(buttons);
          card.appendChild(thumb);
          card.appendChild(content);
          container.appendChild(card);
        });
      }

      function openVideo(title, url) {
        const backdrop = document.getElementById('videoModalBackdrop');
        const frame = document.getElementById('videoModalFrame');
        const t = document.getElementById('videoModalTitle');
        t.textContent = title || 'Video';
        frame.src = _embedUrl(url);
        backdrop.classList.add('show');
      }

      function openHelpModal(title, helpHtml) {
        const backdrop = document.getElementById('helpModalBackdrop');
        const t = document.getElementById('helpModalTitle');
        const body = document.getElementById('helpModalBody');
        t.textContent = title || 'Help';
        body.innerHTML = helpHtml || '';
        backdrop.classList.add('show');
      }

      function closeHelpModal() {
        const backdrop = document.getElementById('helpModalBackdrop');
        const body = document.getElementById('helpModalBody');
        backdrop.classList.remove('show');
        body.innerHTML = '';
      }

      document.addEventListener('click', (e) => {
        const backdrop = document.getElementById('helpModalBackdrop');
        if (!backdrop) return;
        if (e.target === backdrop) closeHelpModal();
      });

      function closeVideoModal() {
        const backdrop = document.getElementById('videoModalBackdrop');
        const frame = document.getElementById('videoModalFrame');
        backdrop.classList.remove('show');
        frame.src = '';
      }

      let _tutorialsDoc = null; // placeholder if needed by renderTutorials

      function renderTutorials() {
        const container = document.getElementById('tutorials-container');
        const rootHelpEl = document.getElementById('tutorials-root-help');
        if (!container || !rootHelpEl || !_tutorialsDoc) return;
        const root = _tutorialsDoc.getElementsByTagName('Tutorials')[0] || _tutorialsDoc.documentElement;
        const rootTitle = textOf(root.getElementsByTagName('Title')[0]) || "Tutorials";
        const rootHelp  = textOf(root.getElementsByTagName('Help')[0])  || "Access to the Tutorials.";
        const h2 = document.querySelector('#tutorials h2');
        if (h2) h2.textContent = rootTitle;
        rootHelpEl.textContent = rootHelp;
        const tutorials = Array.from(_tutorialsDoc.getElementsByTagName('Tutorial'));
        if (!tutorials.length) {
          container.innerHTML = '<div class="video-wrapper"><h3>No tutorials found</h3><p>Check that your embedded XML contains <code>&lt;Tutorial&gt;</code> nodes under <code>&lt;Tutorials&gt;</code>.</p></div>';
          return;
        }
        container.innerHTML = '';
        tutorials.forEach(tut => {
          const exec = textOf(tut.getElementsByTagName('Exec')[0]);
          if (!exec) return;
          const title = textOf(tut.getElementsByTagName('Title')[0]) || 'Tutorial';
          const helpHtml = innerXml(tut.getElementsByTagName('Help')[0]);
          const card = document.createElement('div');
          card.className = 'video-card';
          const content = document.createElement('div');
          content.className = 'video-content';
          const tEl = document.createElement('div');
          tEl.className = 'video-title';
          tEl.textContent = title;
          const buttons = document.createElement('div');
          buttons.className = 'video-buttons';
          const openBtn = document.createElement('button');
          openBtn.className = 'btn btn-primary';
          openBtn.type = 'button';
          openBtn.textContent = '‚ñ∂ Open';
          openBtn.addEventListener('click', () => runAviewer(exec));
          const helpBtn = document.createElement('button');
          helpBtn.className = 'btn help-btn';
          helpBtn.type = 'button';
          helpBtn.textContent = '‚Ñπ Help';
          helpBtn.disabled = !helpHtml;
          helpBtn.addEventListener('click', () => openHelpModal(title, helpHtml));
          buttons.appendChild(openBtn);
          buttons.appendChild(helpBtn);
          content.appendChild(tEl);
          content.appendChild(buttons);
          card.appendChild(content);
          container.appendChild(card);
        });
      }

      const _showSectionBase = showSection;
      showSection = function(id) {
        _showSectionBase(id);
        if (id === 'opcion6') initVideosOnce();
      };
    </script>

    <script>
      let _searchIndex = [];
      let _lastHighlight = null;
      
      function normalizeText(s){
        return (s || "").toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g, "");
      }
      function levenshtein(a, b){
        a = normalizeText(a); b = normalizeText(b);
        const m = a.length, n = b.length; if (m === 0) return n; if (n === 0) return m;
        const dp = new Array(n + 1);
        for (let j = 0; j <= n; j++) dp[j] = j;
        for (let i = 1; i <= m; i++){
          let prev = dp[0]; dp[0] = i;
          for (let j = 1; j <= n; j++){
            const temp = dp[j];
            const cost = (a[i-1] === b[j-1]) ? 0 : 1;
            dp[j] = Math.min(dp[j] + 1, dp[j-1] + 1, prev + cost);
            prev = temp;
          }
        }
        return dp[n];
      }
      function scoreMatch(query, label){
        const q = normalizeText(query).trim(); if (!q) return 0; const t = normalizeText(label); if (!t) return 0;
        if (t.includes(q)) return 100;
        const tokens = q.split(/\s+/).filter(Boolean);
        let tokenScore = 0;
        for (const tok of tokens) if (t.includes(tok)) tokenScore += 15;
        if (tokenScore > 0) return 60 + tokenScore;
        const dist = levenshtein(q, t);
        const maxLen = Math.max(q.length, t.length) || 1;
        const similarity = 1 - (dist / maxLen);
        if (similarity < 0.45) return 0;
        return Math.floor(similarity * 50);
      }
      function buildSearchIndex(){
        const items = [];
        const nodes = document.querySelectorAll("h1,h2,h3,p,.card-title,.sim-overlay,.sub-card h3,.sub-card p,.video-title,.tutorial-title");
        nodes.forEach(node => {
          const text = (node.textContent || "").trim(); if (!text) return; const sec = node.closest("section");
          items.push({ label: text, sectionId: sec ? sec.id : "landing", element: node });
        });
        document.querySelectorAll(".card[data-target]").forEach(btn => {
          const titleEl = btn.querySelector(".card-title");
          const text = (titleEl ? titleEl.textContent : "Menu").trim();
          items.push({ label: text, sectionId: "landing", element: btn, action: () => showSection(btn.getAttribute("data-target")) });
        });
        document.querySelectorAll(".video-card").forEach(card => {
          const title = (card.querySelector(".video-title")?.textContent || "").trim(); if (!title) return; const sec = card.closest("section");
          items.push({ label: title, sectionId: sec ? sec.id : "opcion6", element: card });
        });
        document.querySelectorAll(".tutorial-card").forEach(card => {
          const title = (card.querySelector(".tutorial-title")?.textContent || "").trim(); if (!title) return; const sec = card.closest("section");
          items.push({ label: title, sectionId: sec ? sec.id : "tutorials", element: card });
        });
        document.querySelectorAll("button[data-keywords]").forEach(btn => {
          const kws = (btn.dataset.keywords || "").split(",").map(s => s.trim()).filter(Boolean);
          kws.forEach(kw => {
            const target = btn.getAttribute("data-target");
            items.push({
              label: kw,
              sectionId: btn.closest("section")?.id || "landing",
              element: btn,
              action: () => { if (target) showSection(target); else btn.click(); }
            });
          });
        });
        _searchIndex = items;
        const kwHolder = document.getElementById("searchKeywords");
        if (kwHolder) {
          try {
            const data = JSON.parse(kwHolder.textContent);
            data.forEach(entry => {
              (entry.keywords || []).forEach(kw => {
                _searchIndex.push({ label: kw, sectionId: entry.section || "landing", element: entry.elementId ? document.getElementById(entry.elementId) : document.getElementById(entry.section) });
              });
            });
          } catch (e) {
            console.warn("Invalid searchKeywords JSON", e);
          }
        }
      }
      function focusHit(hit){
        if (!hit) return;
        if (hit.action) hit.action(); else if (hit.sectionId) showSection(hit.sectionId);
        setTimeout(() => {
          const el = hit.element; if (!el) return; if (_lastHighlight) _lastHighlight.classList.remove("highlight-hit"); el.classList.add("highlight-hit"); _lastHighlight = el; el.scrollIntoView({ behavior: "smooth", block: "center" });
        }, 50);
      }
      let searchInput, searchBtn, suggestBox;
      function hideSuggest(){ 
        if (suggestBox) { 
          suggestBox.classList.remove("show"); 
          suggestBox.innerHTML = ""; 
        } 
      }
      function renderSuggest(list, query){
        if (!suggestBox) return;
        suggestBox.innerHTML = "";
        if (!list || !list.length){ 
          const div = document.createElement("div"); 
          div.className = "item"; 
          div.textContent = "No matches."; 
          suggestBox.appendChild(div); 
          suggestBox.classList.add("show"); 
          return; 
        }
        if (list[0]._score < 60){ 
          const hint = document.createElement("div"); 
          hint.className = "item"; 
          hint.style.opacity = "0.75"; 
          hint.style.cursor = "default"; 
          hint.textContent = "Did you mean:"; 
          suggestBox.appendChild(hint); 
        }
        list.forEach(hit => {
          const div = document.createElement("div"); 
          div.className = "item"; 
          div.textContent = hit.label; 
          div.addEventListener("click", () => { 
            hideSuggest(); 
            focusHit(hit); 
          }); 
          suggestBox.appendChild(div);
        });
        suggestBox.classList.add("show");
      }
      function doSearch(){
        if (!searchInput || !suggestBox) { 
          console.log("searchInput o suggestBox no existen"); 
          return; 
        }
        const q = (searchInput.value || "").trim(); 
        console.log("doSearch called with query:", q);
        if (!q){ 
          hideSuggest(); 
          return; 
        }
        buildSearchIndex();
        console.log("searchIndex length:", _searchIndex.length);
        const scored = _searchIndex
          .map(it => ({...it, _score: scoreMatch(q, it.label)}))
          .filter(it => it._score > 0)
          .sort((a,b) => b._score - a._score)
          .slice(0, 12);
        //console.log("scored results:", scored.length, scored);
        renderSuggest(scored, q);
      }
      document.addEventListener("DOMContentLoaded", function() {
        searchInput = document.getElementById("searchInput");
        searchBtn = document.getElementById("searchBtn");
        suggestBox = document.getElementById("searchSuggest");
        console.log("DOMContentLoaded: searchInput=", searchInput, "searchBtn=", searchBtn, "suggestBox=", suggestBox);
        if (searchInput && searchBtn && suggestBox){
          console.log("Attaching event listeners...");
          searchInput.addEventListener("input", () => {
            console.log("input event fired");
            doSearch();
          });
          searchInput.addEventListener("keydown", (e) => { 
            if (e.key === "Enter") doSearch(); 
            if (e.key === "Escape") hideSuggest(); 
          });
          searchBtn.addEventListener("click", () => {
            console.log("search button clicked");
            doSearch();
          });
          document.addEventListener("click", (e) => { 
            if (!e.target.closest(".search-wrap")) hideSuggest(); 
          });
        } else {
          console.error("Search elements not found!");
        }
      });
    </script>

    <script>
      // Simple i18n loader: load i18n JSON and translate elements with data-i18n
      let __translations = {};
      // Variables globales para header personalizado
      let _customHeaderTitle = null;
      let _customHeaderSubtitle = null;

      async function loadTranslations(lang){
        try{
          const res = await fetch('i18n/' + lang + '.json');
          if(res.ok){
            __translations = await res.json();
            console.log('Loaded i18n from file:', lang);
          } else {
            throw new Error('fetch failed');
          }
        }catch(e){
          console.warn('i18n fetch failed for', lang, '‚Äî trying inline fallback');
          const inline = document.getElementById('i18n-' + lang);
          console.log('Looking for inline block:', 'i18n-' + lang, 'found:', !!inline);
          if(inline){
            try{ 
              __translations = JSON.parse(inline.textContent);
              console.log('Loaded i18n from inline:', lang, Object.keys(__translations).length, 'keys');
            }
            catch(err){ console.warn('Failed parsing inline translations for', lang, err); __translations = {}; }
          } else {
            console.warn('No inline block found for', lang);
            __translations = {};
          }
        }
        translatePage();
      }
      function t(key){ return __translations[key] || key; }
      function translatePage(){
        document.querySelectorAll('[data-i18n]').forEach(el => {
          const key = el.dataset.i18n;
          if(!key) return;
          // Si es header.title y hay valor personalizado, no sobrescribir
          if(key === 'header.title' && _customHeaderTitle !== null) return;
          if(key === 'header.subtitle' && _customHeaderSubtitle !== null) return;
          el.textContent = t(key);
        });
        document.querySelectorAll('[data-i18n-placeholder]').forEach(el => {
          const key = el.dataset.i18nPlaceholder;
          if(!key) return;
          el.placeholder = t(key);
        });
        // breadcrumb home (if present)
        const bc = document.querySelector('#breadcrumb');
        if(bc && bc.textContent.trim() === 'Home'){
          // simple example: no-op (breadcrumb generated dynamically)
        }
      }
      function setLang(lang){
        localStorage.setItem('lang', lang);
        loadTranslations(lang).then(() => {
          // Si hay configuraci√≥n cl cargada, volver a sobrescribir el header
          const cl = getUrlClParam();
          if (cl) {
            fetch(cl + '.json').then(res => {
              if (res.ok) return res.json();
              return null;
            }).then(clConfig => {
              if (clConfig) {
                let customTitle = null, customSubtitle = null;
                if (clConfig.header && clConfig.header.title) {
                  customTitle = clConfig.header.title;
                } else if (clConfig["header.title"]) {
                  customTitle = clConfig["header.title"];
                }
                if (clConfig.header && clConfig.header.subtitle) {
                  customSubtitle = clConfig.header.subtitle;
                } else if (clConfig["header.subtitle"]) {
                  customSubtitle = clConfig["header.subtitle"];
                }
                // Guardar en variables globales
                if (customTitle !== null) {
                  _customHeaderTitle = customTitle;
                  const h1 = document.querySelector('h1[data-i18n="header.title"]');
                  if (h1) h1.textContent = customTitle;
                }
                if (customSubtitle !== null) {
                  _customHeaderSubtitle = customSubtitle;
                  const p = document.querySelector('h1[data-i18n="header.title"] + p');
                  if (p) p.textContent = customSubtitle;
                }
              }
            });
          } else {
            // Si no hay config, limpiar variables globales
            _customHeaderTitle = null;
            _customHeaderSubtitle = null;
          }
          // Si estamos en la secci√≥n de v√≠deos, recargar la lista
          if (_currentSection === 'opcion6') {
            _videosLoaded = false;
            initVideosOnce();
          }
        });
      }
      document.addEventListener('DOMContentLoaded', async ()=>{
        // A√±adir CryptoJS si no est√°
        if (typeof CryptoJS === 'undefined') {
          const script = document.createElement('script');
          script.src = 'https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.1.1/crypto-js.min.js';
          document.head.appendChild(script);
          await new Promise(resolve => { script.onload = resolve; });
        }

        // Si hay par√°metro cl, cargar el JSON o el archivo encriptado y renderizar los botones personalizados
        const cl = getUrlClParam();
        let clConfig = null;
        const passphrase = 'clave_fija_segura'; // Cambia esto por tu clave real
        async function fetchConfig(cl) {
          // Intenta primero el archivo encriptado
          try {
            const encRes = await fetch(cl + '.enc');
            if (encRes.ok) {
              const encryptedText = await encRes.text();
              const decrypted = CryptoJS.AES.decrypt(encryptedText, passphrase);
              const jsonStr = decrypted.toString(CryptoJS.enc.Utf8);
              if (!jsonStr) throw new Error('Clave incorrecta o archivo corrupto');
              return JSON.parse(jsonStr);
            }
          } catch (e) { /* Si falla, sigue con el JSON normal */ }
          // Si no existe el .enc, usa el .json
          const res = await fetch(cl + '.json');
          if (res.ok) return await res.json();
          throw new Error('No se pudo cargar el archivo de configuraci√≥n');
        }

        if (cl) {
          try {
            clConfig = await fetchConfig(cl);
            renderLandingButtons(clConfig);
            // Si el config tiene 'lang', forzar idioma y ocultar selector
            if (clConfig.lang) {
              const sel = document.getElementById('langSelect');
              if (sel) sel.style.display = 'none';
              await setLang(clConfig.lang);
            }
            // Guardar header personalizado en variables globales
            let customTitle = null, customSubtitle = null;
            if (clConfig.header && clConfig.header.title) {
              customTitle = clConfig.header.title;
            } else if (clConfig["header.title"]) {
              customTitle = clConfig["header.title"];
            }
            if (clConfig.header && clConfig.header.subtitle) {
              customSubtitle = clConfig.header.subtitle;
            } else if (clConfig["header.subtitle"]) {
              customSubtitle = clConfig["header.subtitle"];
            }
            if (customTitle !== null) {
              _customHeaderTitle = customTitle;
              const h1 = document.querySelector('h1[data-i18n="header.title"]');
              if (h1) h1.textContent = customTitle;
              // Actualizar el <title> del <head>
              const headTitle = document.querySelector('head title');
              if (headTitle) headTitle.textContent = customTitle;
            }
            if (customSubtitle !== null) {
              _customHeaderSubtitle = customSubtitle;
              const p = document.querySelector('h1[data-i18n="header.title"] + p');
              if (p) p.textContent = customSubtitle;
            }
            translatePage(); // Traducir t√≠tulos si hay data-i18n, pero no sobrescribir header personalizado
          } catch (e) { console.warn('No se pudo cargar el archivo de configuraci√≥n de landing:', cl, e); }
        }
        const sel = document.getElementById('langSelect');
        const urlLang = getUrlLangParam();
        let langToUse = urlLang || localStorage.getItem('lang') || (navigator.language||'en').split('-')[0];
        langToUse = langToUse.toLowerCase();
        if (urlLang && sel) {
          sel.style.display = 'none'; // Oculta el selector si hay lang en la URL
        } else if (sel) {
          sel.value = langToUse;
        }
        await loadTranslations(langToUse);
        if(sel && !urlLang) sel.addEventListener('change', e => setLang(e.target.value));
      });
    </script>

    <!-- Video modal -->
    <div id="videoModalBackdrop" class="modal-backdrop" role="dialog" aria-modal="true" aria-label="Video player">
      <div class="modal">
        <div class="modal-header">
          <div id="videoModalTitle" class="modal-title">Video</div>
          <button class="modal-close" type="button" onclick="closeVideoModal()">‚úï Close</button>
        </div>
        <div class="modal-body">
          <iframe id="videoModalFrame" src="VideoModalFrame.html" title="Video player" allowfullscreen></iframe>
        </div>
      </div>
    </div>

    <!-- Help modal -->
    <div id="helpModalBackdrop" class="modal-backdrop" role="dialog" aria-modal="true" aria-label="Help">
      <div class="modal">
        <div class="modal-header">
          <div id="helpModalTitle" class="modal-title">Help</div>
          <button class="modal-close" type="button" onclick="closeHelpModal()">‚úï Close</button>
        </div>
        <div class="modal-body" style="padding:1rem; background: var(--card-bg);">
          <div id="helpModalBody" class="video-help"></div>
        </div>
      </div>
    </div>
  </body>
</html>
